;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ed532754-4275-776b-f7ea-2a238babd0a6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,693241,e=>{"use strict";var t=e.i(478902),s=e.i(710483);let r=({resourceText:e,isFullPage:r=!1})=>{let a=()=>(0,t.jsx)(s.Admonition,{type:"warning",title:`You need additional permissions to ${e}`,description:"Contact your organization owner or administrator for assistance."});return r?(0,t.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,t.jsx)("div",{className:"max-w-lg",children:(0,t.jsx)(a,{})})}):(0,t.jsx)(a,{})};e.s(["NoPermission",0,r,"default",0,r])},124532,e=>{"use strict";var t=e.i(478902),s=e.i(843778);function r({title:e,description:r,illustration:a,actions:i,className:l}){return(0,t.jsxs)("div",{className:(0,s.cn)("rounded-lg border p-4 space-y-3","bg-muted/10 border-border/50","text-left [&_*]:text-left [&_div]:items-start",l),children:[a&&(0,t.jsx)("div",{className:"flex justify-start items-start",children:a}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-medium text-sm text-foreground",children:e}),(0,t.jsx)("p",{className:"text-xs text-foreground-light",children:r})]}),i&&(0,t.jsx)("div",{className:"flex justify-start items-start gap-x-2",children:i})]})}e.s(["FeaturePreviewSidebarPanel",()=>r])},275887,e=>{"use strict";let t=(0,e.i(388019).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>t],275887)},737051,e=>{"use strict";e.i(128328);var t=e.i(657588),s=e.i(265735);e.s(["useIsETLPrivateAlpha",0,()=>{let{data:e}=(0,s.useSelectedOrganizationQuery)(),r=(0,t.useFlag)("etlPrivateAlpha"),a="string"==typeof r?r.split(",").map(e=>e.trim()):[];return(0,t.useFlag)("etlPrivateAlphaOverride")||a.includes(e?.slug??"")}])},237664,e=>{"use strict";e.s(["replicationKeys",0,{sources:e=>["projects",e,"sources"],destinations:e=>["projects",e,"destinations"],destinationById:(e,t)=>["projects",e,"destinations",t],publications:(e,t)=>["projects",e,"sources",t,"publications"],tables:(e,t)=>["projects",e,"sources",t,"tables"],pipelines:e=>["projects",e,"pipelines"],pipelineById:(e,t)=>["projects",e,"pipelines",t],pipelinesStatus:(e,t)=>["projects",e,"pipelines",t,"status"],pipelinesReplicationStatus:(e,t)=>["projects",e,"pipelines",t,"replication-status"],pipelinesVersion:(e,t)=>["projects",e,"pipelines",t,"version"]}])},344409,633089,e=>{"use strict";var t=e.i(242882),s=e.i(234745),r=e.i(237664),a=e.i(741391);e.i(56031);var i=e.i(237948);let l=(e,t)=>!(t instanceof i.ResponseError&&503===t.code&&t.message.includes("feature flag is required"))&&e<a.MAX_RETRY_FAILURE_COUNT;async function n({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:r,error:a}=await (0,s.get)("/platform/replication/{ref}/sources",{params:{path:{ref:e}},signal:t});return a&&(0,s.handleError)(a),r}e.s(["checkReplicationFeatureFlagRetry",0,l],633089),e.s(["useReplicationSourcesQuery",0,({projectRef:e},{enabled:s=!0,...a}={})=>(0,t.useQuery)({queryKey:r.replicationKeys.sources(e),queryFn:({signal:t})=>n({projectRef:e},t),enabled:s&&void 0!==e,refetchOnMount:!1,refetchOnWindowFocus:!1,retry:l,...a})],344409)},281050,e=>{"use strict";var t=e.i(50470);e.s(["CircleHelpIcon",()=>t.default])},421605,276708,e=>{"use strict";var t=e.i(478902),s=e.i(898452),r=e.i(389959),a=e.i(355901);e.i(128328);var i=e.i(158639),l=e.i(586011),n=e.i(420985),o=e.i(874311),c=e.i(466472),d=e.i(837710),u=e.i(441345),p=e.i(171997),m=e.i(40892);let h=({visible:e,onCancel:s,onSubmit:r,initialValues:a})=>(0,t.jsx)(m.Modal,{visible:e,onCancel:s,hideFooter:!0,header:"Update saved query",size:"medium",children:(0,t.jsx)(u.Form,{onReset:s,validateOnBlur:!0,initialValues:a,validate:function(e){let t={};return e.name||(t.name="Required"),t},onSubmit:r,children:({isSubmitting:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Modal.Content,{children:(0,t.jsx)(p.Input,{label:"Name",id:"name",name:"name"})}),(0,t.jsx)(m.Modal.Content,{children:(0,t.jsx)(p.Input.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none"})}),(0,t.jsx)(m.Modal.Separator,{}),(0,t.jsxs)(m.Modal.Content,{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(d.Button,{htmlType:"reset",type:"default",onClick:s,disabled:e,children:"Cancel"}),(0,t.jsx)(d.Button,{htmlType:"submit",loading:e,disabled:e,children:"Save query"})]})]})})});var f=e.i(53071),g=e.i(211570);e.i(481541);var x=e.i(171137),j=e.i(275887),y=e.i(215261),b=e.i(843778);function v({label:e,icon:s,dropdownItems:r,href:a,isActive:i,onClick:l}){return(0,t.jsxs)("div",{className:(0,b.cn)({"bg-foreground-lighter/10":i},"relative flex [&:has([data-state=open])]:bg-foreground-lighter/10 [&:has([data-state=open])]:text-foreground hover:text-foreground hover:bg-foreground-lighter/10 transition-all text-foreground-light group"),children:[(0,t.jsxs)(y.default,{onClick:l,href:a,className:"h-7 flex-1 text-sm px-4 flex items-center gap-2 truncate",children:[(0,t.jsx)("span",{children:s}),(0,t.jsx)("span",{className:"truncate",children:e})]}),r&&(0,t.jsxs)(o.DropdownMenu,{children:[(0,t.jsx)(o.DropdownMenuTrigger,{asChild:!0,onClick:e=>{e.preventDefault()},children:(0,t.jsx)(d.Button,{type:"text",title:"Actions",className:"space-x-0 h-7 px-1.5 opacity-0 group-hover:opacity-100 !bg-transparent data-[state=open]:opacity-100",icon:(0,t.jsx)(j.MoreHorizontal,{size:14}),children:(0,t.jsx)("div",{className:"sr-only",children:"Actions"})})}),(0,t.jsx)(o.DropdownMenuContent,{className:"w-48",align:"end",children:r})]})]})}e.s(["LogsSidebarItem",()=>v],276708),e.s(["default",0,({item:e})=>{let d=(0,s.useRouter)(),{ref:u}=(0,i.useParams)(),[p,m]=(0,r.useState)(!1),[j,y]=(0,r.useState)(!1),{mutate:b}=(0,l.useContentDeleteMutation)({onSuccess:()=>{m(!1),a.toast.success("Successfully deleted query")},onError:e=>{a.toast.error(`Failed to delete saved query: ${e.message}`)}}),{mutate:_}=(0,n.useContentUpsertMutation)({onSuccess:()=>{y(!1),a.toast.success("Successfully updated query")},onError:e=>{a.toast.error(`Failed to update query: ${e.message}`)}}),S=async()=>{if(!u||"string"!=typeof u)return console.error("Invalid project reference");b({projectRef:u,ids:[e.id]})},C=async({name:t,description:s})=>{if(!u||"string"!=typeof u)return console.error("Invalid project reference");_({projectRef:u,payload:{...e,name:t,description:s||void 0,type:"log_sql",visibility:"user"}})},P=d.query.queryId===e.id;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{label:e.name,icon:(0,t.jsx)(x.SqlEditor,{size:"15"}),href:`/project/${u}/logs/explorer?queryId=${encodeURIComponent(e.id)}&q=${encodeURIComponent(e.content.sql)}`,isActive:P,dropdownItems:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.DropdownMenuItem,{onClick:()=>y(!0),children:[(0,t.jsx)(f.Edit,{size:14,className:"mr-2"}),"Edit query"]}),(0,t.jsx)(o.DropdownMenuSeparator,{}),(0,t.jsxs)(o.DropdownMenuItem,{onClick:()=>{m(!0)},children:[(0,t.jsx)(g.Trash,{size:14,className:"mr-2"}),"Delete query"]})]})}),(0,t.jsx)(c.default,{variant:"destructive",visible:p,confirmLabel:"Delete query",title:"Confirm to delete saved query",onCancel:()=>{m(!1)},onConfirm:S,children:(0,t.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete ",e.name,"?"]})}),(0,t.jsx)(h,{visible:j,initialValues:{name:e.name,description:e.description},onCancel:()=>{y(!1)},onSubmit:e=>{C(e)}})]})}],421605)},20318,e=>{"use strict";var t=e.i(478902),s=e.i(902858),r=e.i(693241),a=e.i(2579),i=e.i(951138),l=e.i(825713),n=e.i(416050),o=e.i(281050),c=e.i(479232),d=e.i(215261),u=e.i(898452),p=e.i(389959);e.i(128328);var m=e.i(86086),h=e.i(657588),f=e.i(158639),g=e.i(463333),x=e.i(737051),j=e.i(223173),y=e.i(421605),b=e.i(276708),v=e.i(215312),_=e.i(929461),S=e.i(344409),C=e.i(25123),P=e.i(912793),w=e.i(587433),k=e.i(837710),N=e.i(843778),E=e.i(925282),R=e.i(774234),T=e.i(554855),A=e.i(479095),L=e.i(498377),I=e.i(108151),M=e.i(124532);let D=({className:e})=>(0,t.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 24 24",height:"15px",width:"15px",className:e,xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M10.9997 2.59833V13.9694H3.90013C3.23055 13.9694 2.83063 13.1846 3.25654 12.6326L10.9997 2.59833ZM12.9997 8.03061V2.33296C12.9997 0.521514 10.7034 -0.291434 9.58194 1.16185L1.67316 11.4108C0.246185 13.26 1.54768 15.9694 3.90013 15.9694H10.9997V21.6671C10.9997 23.4785 13.296 24.2915 14.4175 22.8382L22.3262 12.5892C23.7532 10.74 22.4517 8.03061 20.0993 8.03061H12.9997ZM12.9997 10.0306H20.0993C20.7688 10.0306 21.1688 10.8155 20.7429 11.3674L12.9997 21.4017V10.0306Z"})});function F({children:e,title:s,defaultOpen:r}){return(0,t.jsxs)(E.Collapsible_Shadcn_,{defaultOpen:r,children:[(0,t.jsxs)(T.CollapsibleTrigger_Shadcn_,{className:"flex items-center gap-x-2 px-4 [&[data-state=open]>svg]:!rotate-90 pb-2",children:[(0,t.jsx)(n.ChevronRight,{size:16,className:"text-foreground-light transition-transform duration-200"}),(0,t.jsx)("span",{className:"text-foreground-light font-mono text-sm uppercase",children:s})]}),(0,t.jsx)(R.CollapsibleContent_Shadcn_,{children:e})]})}function q(){let e=(0,u.useRouter)(),{ref:s}=(0,f.useParams)(),r=(0,h.useFlag)("unifiedLogs"),{selectFeaturePreview:a}=(0,g.useFeaturePreviewModal)(),{enable:i}=(0,g.useUnifiedLogsPreview)(),[l,n]=(0,p.useState)(""),{projectAuthAll:E,projectStorageAll:R,realtimeAll:T,logsTemplates:q,logsCollections:O}=(0,P.useIsFeatureEnabled)(["project_storage:all","project_auth:all","realtime:all","logs:templates","logs:collections"]),$=(0,x.useIsETLPrivateAlpha)(),{data:z,isPending:B}=(0,S.useReplicationSourcesQuery)({projectRef:s},{enabled:$,retry:!1,refetchOnMount:!1,refetchOnWindowFocus:!1}),U=$&&(z?.sources?.length??0)>0&&!B,{plan:H}=(0,C.useCurrentOrgPlan)(),G=H?.id==="free",{data:V,isPending:K}=(0,_.useContentQuery)({projectRef:s,type:"log_sql"}),Z=[...V?.content??[]].filter(e=>"log_sql"===e.type).sort((e,t)=>e.name.localeCompare(t.name));function X(t){return e.asPath.includes(t)}let Q=[{name:"API Gateway",key:"edge-logs",url:`/project/${s}/logs/edge-logs`,items:[]},{name:"Postgres",key:"postgres-logs",url:`/project/${s}/logs/postgres-logs`,items:[]},{name:"PostgREST",key:"postgrest-logs",url:`/project/${s}/logs/postgrest-logs`,items:[]},m.IS_PLATFORM?{name:G?"Pooler":"Shared Pooler",key:"pooler-logs",url:`/project/${s}/logs/pooler-logs`,items:[]}:null,!G&&m.IS_PLATFORM?{name:"Dedicated Pooler",key:"dedicated-pooler-logs",url:`/project/${s}/logs/dedicated-pooler-logs`,items:[]}:null,E?{name:"Auth",key:"auth-logs",url:`/project/${s}/logs/auth-logs`,items:[]}:null,R?{name:"Storage",key:"storage-logs",url:`/project/${s}/logs/storage-logs`,items:[]}:null,T?{name:"Realtime",key:"realtime-logs",url:`/project/${s}/logs/realtime-logs`,items:[]}:null,{name:"Edge Functions",key:"edge-functions-logs",url:`/project/${s}/logs/edge-functions-logs`,items:[]},{name:"Cron",key:"pg_cron",url:`/project/${s}/logs/pgcron-logs`,items:[]},U?{name:"Replication",key:"replication_logs",url:`/project/${s}/logs/replication-logs`,items:[]}:null].filter(e=>null!==e),W=m.IS_PLATFORM?[{name:"Postgres Version Upgrade",key:"pg-upgrade-logs",url:`/project/${s}/logs/pg-upgrade-logs`,items:[]}]:[],Y=Q.filter(e=>e?.name.toLowerCase().includes(l.toLowerCase())),J=W.filter(e=>e?.name.toLowerCase().includes(l.toLowerCase()));return(0,t.jsxs)("div",{className:"pb-4 relative",children:[m.IS_PLATFORM&&!r&&(0,t.jsx)(M.FeaturePreviewSidebarPanel,{className:"mx-4 mt-4",illustration:(0,t.jsx)(w.Badge,{variant:"default",children:"Coming soon"}),title:"New logs",description:"Get early access",actions:(0,t.jsx)(d.default,{href:"https://forms.supabase.com/unified-logs-signup",target:"_blank",children:(0,t.jsx)(k.Button,{type:"default",size:"tiny",children:"Early access"})})}),r&&(0,t.jsx)(M.FeaturePreviewSidebarPanel,{className:"mx-4 mt-4",title:"Introducing unified logs",description:"A unified view across all services with improved filtering and real-time updates.",illustration:(0,t.jsx)(w.Badge,{variant:"success",children:"New"}),actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Button,{size:"tiny",type:"default",onClick:()=>{i(),e.push(`/project/${s}/logs`)},children:"Enable preview"}),(0,t.jsx)(v.ButtonTooltip,{type:"default",className:"px-1.5",icon:(0,t.jsx)(o.CircleHelpIcon,{}),onClick:()=>a("supabase-ui-preview-unified-logs"),tooltip:{content:{side:"bottom",text:"More information"}}})]})}),(0,t.jsxs)("div",{className:(0,N.cn)("flex gap-x-2 items-center sticky top-0 bg-background-200 z-[1] px-4",q?"py-4":"pt-4"),children:[(0,t.jsx)(L.InnerSideBarFilters,{className:"w-full p-0 gap-0",children:(0,t.jsx)(L.InnerSideBarFilterSearchInput,{name:"search-collections",placeholder:"Search collections...","aria-labelledby":"Search collections",value:l,onChange:e=>n(e.target.value)})}),(0,t.jsx)(k.Button,{type:"default",icon:(0,t.jsx)(c.Plus,{className:"text-foreground"}),className:"w-[26px]",onClick:()=>e.push(`/project/${s}/logs/explorer`)})]}),q&&(0,t.jsx)("div",{className:"px-2",children:(0,t.jsx)(L.InnerSideMenuItem,{title:"Templates",isActive:X(`/project/${s}/logs/explorer/templates`),href:`/project/${s}/logs/explorer/templates`,children:"Templates"})}),(0,t.jsx)(A.Separator,{className:"my-4"}),O&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F,{title:"Collections",defaultOpen:!0,children:Y.map(e=>{let s=X(e?.url??"");return(0,t.jsx)(b.LogsSidebarItem,{isActive:s,href:e?.url??"",icon:(0,t.jsx)(D,{className:"text-foreground-light"}),label:e?.name??""},e?.key??"")})}),W.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.Separator,{className:"my-4"}),(0,t.jsx)(F,{title:"Database operations",defaultOpen:!0,children:J.map(e=>(0,t.jsx)(b.LogsSidebarItem,{isActive:X(e.url),href:e.url,icon:(0,t.jsx)(D,{className:"text-foreground-light"}),label:e.name},e.key))})]}),(0,t.jsx)(A.Separator,{className:"my-4"})]}),(0,t.jsxs)(F,{title:"Queries",defaultOpen:!0,children:[K&&(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(I.GenericSkeletonLoader,{})}),0===Z.length&&(0,t.jsx)(L.InnerSideBarEmptyPanel,{className:"mx-4",title:"No queries created yet",description:"Create and save your queries to use them in the explorer",actions:(0,t.jsx)(k.Button,{asChild:!0,type:"default",children:(0,t.jsx)(d.default,{href:`/project/${s}/logs/explorer`,children:"Create query"})})}),Z.map(e=>(0,t.jsx)(y.default,{item:e},e.id))]}),(0,t.jsx)(A.Separator,{className:"my-4"}),(0,t.jsx)(M.FeaturePreviewSidebarPanel,{className:"mx-4 mt-4",title:"Capture your logs",description:"Send logs to your preferred observability or storage platform.",illustration:(0,t.jsx)("div",{className:"flex items-center gap-4",children:j.LOG_DRAIN_TYPES.map(e=>p.default.cloneElement(e.icon,{height:20,width:20}))}),actions:(0,t.jsx)(k.Button,{asChild:!0,type:"default",children:(0,t.jsx)(d.default,{href:`/project/${s}/settings/log-drains`,children:"Go to Log Drains"})})})]})}let O=(0,i.withAuth)(({title:e,children:i})=>{let{isLoading:n,can:o}=(0,a.useAsyncCheckPermissions)(s.PermissionAction.ANALYTICS_READ,"logflare");if(!o){if(n)return(0,t.jsx)(l.ProjectLayout,{isLoading:!0});if(!n&&!o)return(0,t.jsx)(l.ProjectLayout,{children:(0,t.jsx)(r.default,{isFullPage:!0,resourceText:"access your project's logs"})})}return(0,t.jsx)(l.ProjectLayout,{title:e,product:"Logs & Analytics",productMenu:(0,t.jsx)(q,{}),children:i})});e.s(["default",0,O],20318)},200409,e=>{"use strict";var t=e.i(478902),s=e.i(700856),r=e.i(389959),a=e.i(938933);let i=({defaultActiveId:e,activeId:i,type:l="pills",size:n="tiny",block:o,onChange:c,onClick:d,scrollable:u,wrappable:p,addOnBefore:m,addOnAfter:h,listClassNames:f,baseClassNames:g,refs:x,children:j})=>{let y=r.Children.toArray(j),[b,v]=(0,r.useState)(i??e??y?.[0]?.props?.id);(0,r.useMemo)(()=>{i&&i!==b&&v(i)},[i]);let _=(0,a.default)("tabs");function S(e){d?.(e),e!==b&&(c?.(e),v(e))}let C=[_[l].list];return u&&C.push(_.scrollable),p&&C.push(_.wrappable),f&&C.push(f),(0,t.jsxs)(s.Root,{value:b,className:[_.base,g].join(" "),ref:x?.base,children:[(0,t.jsxs)(s.List,{className:C.join(" "),ref:x?.list,children:[m,y.map(e=>{let r=b===e.props.id,a=[_[l].base,_.size[n]];return r?a.push(_[l].active):a.push(_[l].inactive),o&&a.push(_.block),(0,t.jsxs)(s.Trigger,{onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),S(e.props.id))},onClick:()=>S(e.props.id),value:e.props.id,className:a.join(" "),children:[e.props.icon,(0,t.jsx)("span",{children:e.props.label}),e.props.iconRight]},`${e.props.id}-tab-button`)}),h]}),y]})};i.Panel=({children:e,id:r,className:i})=>{let l=(0,a.default)("tabs");return(0,t.jsx)(s.Content,{value:r,className:[l.content,i].join(" "),children:e})},e.s(["Tabs",0,i],200409)},315641,e=>{"use strict";var t=e.i(857054);e.s(["logConstants",()=>t.default])},42081,e=>{"use strict";let t="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;e.s(["DEBUG_BUILD",()=>t])},672296,e=>{"use strict";function t(e){return e.split("#")[0]}function s(e,t={}){let{maxDepth:r=3,redaction:a="[REDACTED]",truncationNotice:i="[REDACTED: max depth reached]",sensitiveKeys:l=[]}=t,n=new Set(["password","passwd","pwd","pass","secret","token","id_token","access_token","refresh_token","apikey","api_key","api-key","apiKey","key","privatekey","private_key","client_secret","clientSecret","auth","authorization","ssh_key","sshKey","bearer","session","cookie","csrf","xsrf","ip","ip_address","ipAddress","aws_access_key_id","aws_secret_access_key","gcp_service_account_key",...l].map(e=>e.toLowerCase())),o=[{re:/\b(?:(?:25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|1?\d?\d)\b/g,reason:"ip"},{re:/\b(?:[A-Fa-f0-9]{1,4}:){2,7}[A-Fa-f0-9]{1,4}\b/g,reason:"ip6"},{re:/\b(AKI|ASI)A[0-9A-Z]{16}\b/g,reason:"aws_access_key_id"},{re:/\b[0-9A-Za-z/+]{40}\b/g,reason:"aws_secret_access_key_like"},{re:/\bBearer\s+[A-Za-z0-9\-._~+/]+=*\b/g,reason:"bearer"},{re:/\b[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\b/g,reason:"jwt_like"},{re:/\b[A-Za-z0-9_\-]{24,64}\b/g,reason:"long_token"}],c=new WeakMap;function d(e){let t=e;for(let{re:e}of o)t=t.replace(e,a);return t}function u(e){return n.has(String(e).toLowerCase())}return e.map(e=>(function e(t,s){if(null==t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t;if("string"==typeof t)return d(t);if("function"==typeof t)return"[Function]";if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return t.toString();if(ArrayBuffer.isView(t)&&!(t instanceof DataView))return`[TypedArray byteLength=${t.byteLength}]`;if(t instanceof ArrayBuffer)return`[ArrayBuffer byteLength=${t.byteLength}]`;if(s>=r)return i;if("object"==typeof t){if(c.has(t))return"[Circular]";if(Array.isArray(t)){let r=[];c.set(t,r);for(let a=0;a<t.length;a++)r[a]=e(t[a],s+1);return r}if(function(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}(t)){let r={};for(let[i,l]of(c.set(t,r),Object.entries(t)))u(i)?r[i]=a:r[i]=e(l,s+1);return r}if(t instanceof Map){let r=[];for(let[i,l]of(c.set(t,r),t.entries())){let t=u(i)?a:e(i,s+1),n=u(i)?a:e(l,s+1);r.push([t,n])}return r}if(t instanceof Set){let r=[];for(let a of(c.set(t,r),t.values()))r.push(e(a,s+1));return r}if(t instanceof URL)return t.toString();if(t instanceof Error){let e={name:t.name,message:d(t.message),stack:i};return c.set(t,e),e}try{return d(String(t))}catch{return d(Object.prototype.toString.call(t))}}return d(String(t))})(e,0))}e.s(["sanitizeArrayOfObjects",()=>s,"sanitizeUrlHashParams",()=>t])},982760,e=>{"use strict";var t=e.i(478902),s=e.i(156054),r=e.i(202584),a=e.i(55956),i=e.i(898452),l=e.i(389959),n=e.i(355901);e.i(128328);var o=e.i(86086),c=e.i(947748),d=e.i(158639),u=e.i(993394),p=e.i(460988),m=e.i(182074),h=e.i(370410),f=e.i(88816),g=e.i(816467),x=e.i(17203),j=e.i(975924),y=e.i(215261),b=e.i(707843),v=e.i(912793),_=e.i(10429);e.i(427138);var S=e.i(315641),C=e.i(587433),P=e.i(837710),w=e.i(375761),k=e.i(874311),N=e.i(539013),E=e.i(200409),R=e.i(613580),T=e.i(748356);function A({name:e,desc:s}){return(0,t.jsxs)("div",{className:"grid gap-1",children:[(0,t.jsx)("div",{className:"font-mono font-bold",children:e}),s&&(0,t.jsx)("div",{className:"text-foreground-light",children:s})]})}let L=({field:e})=>{let[s,r]=(0,l.useState)(!1);return(0,t.jsxs)(b.default.tr,{children:[(0,t.jsxs)(b.default.td,{className:"font-mono text-xs !p-2 cursor-pointer hover:text-foreground transition flex items-center space-x-2",onClick:()=>(0,w.copyToClipboard)(e.path,()=>{r(!0),setTimeout(()=>r(!1),3e3)}),children:[(0,t.jsx)("span",{children:e.path}),s?(0,t.jsxs)(R.Tooltip,{children:[(0,t.jsx)(R.TooltipTrigger,{children:(0,t.jsx)(h.Check,{size:14,strokeWidth:3,className:"text-brand"})}),(0,t.jsx)(R.TooltipContent,{side:"bottom",children:"Copied"})]}):(0,t.jsxs)(R.Tooltip,{children:[(0,t.jsx)(R.TooltipTrigger,{children:(0,t.jsx)(g.Copy,{size:14,strokeWidth:1.5})}),(0,t.jsx)(R.TooltipContent,{side:"bottom",children:"Copy value"})]})]}),(0,t.jsx)(b.default.td,{className:"font-mono text-xs !p-2",children:e.type})]})},I=({templates:e=[],defaultFrom:s,defaultTo:r,warnings:i,onSelectTemplate:n,onSelectSource:c,onDateChange:d})=>{let[p,h]=(0,l.useState)(!1),{logsTemplates:g}=(0,v.useIsFeatureEnabled)(["logs:templates"]),{projectAuthAll:w,projectStorageAll:I,projectEdgeFunctionAll:M}=(0,v.useIsFeatureEnabled)(["project_auth:all","project_storage:all","project_edge_function:all"]),D=Object.entries(u.LogsTableName).filter(([e])=>"AUTH"===e?w:"STORAGE"===e?I:"FN_EDGE"===e?M:"PG_CRON"!==e).map(([,e])=>e),[F,q]=(0,l.useState)(s&&r?{to:r,from:s,text:`${(0,a.default)(s).format("DD MMM, HH:mm")} - ${(0,a.default)(r).format("DD MMM, HH:mm")}`,isHelper:!1}:{to:u.EXPLORER_DATEPICKER_HELPERS[0].calcTo(),from:u.EXPLORER_DATEPICKER_HELPERS[0].calcFrom(),text:u.EXPLORER_DATEPICKER_HELPERS[0].text,isHelper:!0});return(0,t.jsx)("div",{className:"border-b bg-surface-100",children:(0,t.jsx)("div",{className:"flex w-full items-center justify-between px-4 md:px-5 py-2 overflow-x-scroll no-scrollbar",children:(0,t.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(k.DropdownMenu,{children:[(0,t.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(P.Button,{type:"default",iconRight:(0,t.jsx)(f.ChevronDown,{}),children:"Insert source"})}),(0,t.jsx)(k.DropdownMenuContent,{side:"bottom",align:"start",className:"max-h-[390px] overflow-auto",children:D.sort((e,t)=>e.localeCompare(t)).map(e=>(0,t.jsx)(k.DropdownMenuItem,{onClick:()=>c(e),children:(0,t.jsx)(A,{name:e,desc:u.LOGS_SOURCE_DESCRIPTION[e]})},e))})]}),o.IS_PLATFORM&&g&&(0,t.jsxs)(k.DropdownMenu,{children:[(0,t.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(P.Button,{type:"default",iconRight:(0,t.jsx)(f.ChevronDown,{}),children:"Templates"})}),(0,t.jsx)(k.DropdownMenuContent,{side:"bottom",align:"start",children:e.sort((e,t)=>e.label.localeCompare(t.label)).map(e=>(0,t.jsx)(k.DropdownMenuItem,{onClick:()=>n(e),children:(0,t.jsx)("p",{children:e.label})},e.label))})]}),(0,t.jsx)(T.LogsDatePicker,{value:F,onSubmit:e=>{q(e),d(e)},helpers:u.EXPLORER_DATEPICKER_HELPERS}),(0,t.jsx)("div",{"data-testid":"log-explorer-warnings",className:`transition-all duration-300 h-full ${i.length>0?"opacity-100":"invisible h-0 w-0 opacity-0"}`,children:(0,t.jsx)(R.Tooltip,{children:(0,t.jsxs)(R.TooltipTrigger,{className:"flex items-start",children:[(0,t.jsxs)(C.Badge,{variant:"warning",children:[i.length," ",i.length>1?"warnings":"warning"]}),(0,t.jsx)(R.TooltipContent,{className:"p-0 divide-y max-w-xs",side:"bottom",children:i.map((e,s)=>(0,t.jsxs)("p",{className:"px-3 py-1.5 text-xs text-foreground-light text-left",children:[e.text," ",e.link&&(0,t.jsx)(y.default,{href:e.link,children:e.linkText||"View"})]},s))})]})})})]}),(0,t.jsxs)(N.SidePanel,{size:"large",header:(0,t.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,t.jsx)("h3",{children:"Field Reference"}),(0,t.jsx)(P.Button,{type:"text",className:"px-1",onClick:()=>h(!1),icon:(0,t.jsx)(j.X,{})})]}),visible:p,cancelText:"Close",onCancel:()=>h(!1),hideFooter:!0,triggerElement:(0,t.jsx)(P.Button,{type:"text",onClick:()=>h(!0),icon:(0,t.jsx)(m.BookOpen,{}),className:"px-2",children:(0,t.jsx)("span",{children:"Field Reference"})}),children:[(0,t.jsx)(N.SidePanel.Content,{children:(0,t.jsx)("div",{className:"pt-4 pb-2 space-y-1",children:(0,t.jsxs)("p",{className:"text-sm",children:["The following table shows all the available paths that can be queried from each respective source. Do note that to access nested keys, you would need to perform the necessary"," ",(0,t.jsxs)(y.default,{href:`${_.DOCS_URL}/guides/platform/logs#unnesting-arrays`,target:"_blank",rel:"noreferrer",className:"text-brand",children:["unnesting joins",(0,t.jsx)(x.ExternalLink,{size:"14",className:"ml-1 inline -translate-y-[2px]",strokeWidth:1.5})]})]})})}),(0,t.jsx)(N.SidePanel.Separator,{}),(0,t.jsx)(E.Tabs,{scrollable:!0,size:"small",type:"underlined",defaultActiveId:"edge_logs",listClassNames:"px-2",children:S.logConstants.schemas.map(e=>(0,t.jsx)(E.Tabs.Panel,{id:e.reference,label:e.name,className:"px-4 pb-4",children:(0,t.jsx)(b.default,{head:[(0,t.jsx)(b.default.th,{className:"text-xs !p-2",children:"Path"},"path"),(0,t.jsx)(b.default.th,{className:"text-xs !p-2",children:"Type"},"type")],body:e.fields.sort((e,t)=>e.path-t.path).map(e=>(0,t.jsx)(L,{field:e},e.path))})},e.reference))})]})]})})})};var M=e.i(651068),D=e.i(979377),F=e.i(448710),q=e.i(20318),O=e.i(653961),$=e.i(744244),z=e.i(427432),B=e.i(929461),U=e.i(420985),H=e.i(924529),G=e.i(281192),V=e.i(276093),K=e.i(280590),Z=e.i(169240),X=e.i(48189),Q=e.i(432478),W=e.i(441345),Y=e.i(171997),J=e.i(40892),ee=e.i(725805);let et=()=>{(0,p.useEditorHints)();let e=(0,s.useMonaco)(),m=(0,i.useRouter)(),{profile:h}=(0,Q.useProfile)(),{ref:f,q:g,queryId:x}=(0,d.useParams)(),{logsShowMetadataIpTemplate:j}=(0,v.useIsFeatureEnabled)(["logs:show_metadata_ip_template"]),y=(0,l.useMemo)(()=>j?u.TEMPLATES:u.TEMPLATES.filter(e=>"Metadata IP"!==e.label),[j]),b=(0,l.useRef)(),[_]=(0,l.useState)((0,X.uuidv4)()),{timestampStart:S,timestampEnd:C,setTimeRange:w}=(0,G.useLogsUrlState)(),{logsDefaultQuery:k}=(0,V.useCustomContent)(["logs:default_query"]),N=o.IS_PLATFORM?k??"select\n  cast(timestamp as datetime) as timestamp,\n  event_message, metadata \nfrom edge_logs \nlimit 5":"select\n  timestamp, event_message, metadata\n  from edge_logs limit 5",[E,R]=(0,l.useState)(N),[T,A]=(0,l.useState)(!1),[L,F]=(0,l.useState)([]),[q,et]=(0,l.useState)(null),[es,er]=(0,r.useLocalStorage)(`project-content-${f}-recent-log-sql`,[]),{getEntitlementNumericValue:ea}=(0,K.useCheckEntitlements)("log.retention_days"),ei=ea(),{data:el}=(0,B.useContentQuery)({projectRef:f,type:"log_sql"}),en=el?.content.find(e=>e.id===x),{params:eo,logData:ec,error:ed,isLoading:eu,changeQuery:ep,runQuery:em}=(0,H.default)(f,{iso_timestamp_start:S,iso_timestamp_end:C},!0),{mutate:eh,isPending:ef}=(0,U.useContentUpsertMutation)({onError:e=>{console.error(e),A(!1),x?n.toast.error(`Failed to update query: ${e.message}`):n.toast.error(`Failed to save query: ${e.message}`)},onSuccess:(e,t)=>{A(!1),x?n.toast.success(`Updated "${t.payload.name}" log query`):n.toast.success(`Saved "${t.payload.name}" log query`)}}),eg=e=>{er([...es,{schema_version:"1",sql:"",content_id:"",...e}])},{showUpgradePrompt:ex,setShowUpgradePrompt:ej}=(0,Z.useUpgradePrompt)(eo.iso_timestamp_start),ey=e=>{let t="string"==typeof e&&e||E;ep(t),em(),m.push({pathname:m.pathname,query:{...m.query,q:t}}),eg({sql:t})},eb=async(e,{setSubmitting:t})=>{if(!f)return console.error("Project ref is required");if(!h)return console.error("Profile is required");t(!0);let s=(0,X.uuidv4)();eh({projectRef:f,payload:{id:s,name:e.name,description:e.description||"",type:"log_sql",content:{content_id:_,sql:E,schema_version:"1",favorite:!1},owner_id:h.id,visibility:"user"}},{onSuccess:()=>m.push(`/project/${f}/logs/explorer?queryId=${s}`)})};return(0,l.useEffect)(()=>{g&&R(g)},[g]),(0,l.useEffect)(()=>{let e=[],t=S?(0,a.default)(S):(0,a.default)(),s=C?(0,a.default)(C):(0,a.default)();Math.abs(t.diff(s,"days"))>=u.LOGS_LARGE_DATE_RANGE_DAYS_THRESHOLD&&e.push({text:"Querying large date ranges can be slow. Consider selecting a smaller date range."}),E&&!E.toLowerCase().includes("limit")&&e.push({text:"When querying large date ranges, include a LIMIT clause."}),F(e)},[E,S,C]),(0,l.useEffect)(()=>{S&&(0,p.maybeShowUpgradePromptIfNotEntitled)(S,ei)&&ej(!ex)},[S,ei]),(0,t.jsxs)("div",{className:"w-full h-full mx-auto",children:[(0,t.jsxs)(ee.ResizablePanelGroup,{className:"w-full h-full max-h-screen",direction:"vertical",autoSaveId:c.LOCAL_STORAGE_KEYS.LOG_EXPLORER_SPLIT_SIZE,children:[(0,t.jsxs)(ee.ResizablePanel,{collapsible:!0,minSize:5,children:[(0,t.jsx)(I,{defaultFrom:S||"",defaultTo:C||"",onDateChange:({to:e,from:t})=>{(0,p.maybeShowUpgradePromptIfNotEntitled)(t,ei)?ej(!ex):w(t||"",e||"")},onSelectSource:t=>{if(b.current&&e){let s=b.current?.getModel(),r=b.current.getValue(),a=r.indexOf("from"),i=a<0?`${r}${t}`:`${r.substring(0,a+4)} ${t} ${r.substring(a+5)}`;b.current.pushUndoStop(),b.current.executeEdits("insert-identifier",[{text:i,range:s?.getFullModelRange()??new e.Range(1,1,1,1)}]),b.current.pushUndoStop(),b.current.focus()}},templates:y.filter(e=>"custom"===e.mode),onSelectTemplate:t=>{if(b.current&&e){let s=b.current?.getModel();b.current.pushUndoStop(),b.current.executeEdits("insert-identifier",[{text:t.searchString,range:s?.getFullModelRange()??new e.Range(1,1,1,1)}]),b.current.pushUndoStop(),b.current.focus()}eg({sql:t.searchString})},warnings:L}),(0,t.jsx)(z.default,{active:eu}),(0,t.jsx)(O.default,{id:_,editorRef:b,language:"pgsql",defaultValue:E,onInputChange:e=>R(e||""),actions:{runQuery:{enabled:!0,callback:ey}}})]}),(0,t.jsx)(ee.ResizableHandle,{withHandle:!0}),(0,t.jsx)(ee.ResizablePanel,{collapsible:!0,minSize:5,className:"overflow-auto",children:(0,t.jsxs)($.default,{active:eu,children:[(0,t.jsx)(M.default,{isSaving:ef,showHistogramToggle:!1,onRun:ey,onSave:function(){return f?x&&en?void eh({projectRef:f,payload:{...en,content:{...en.content,sql:E}}}):void A(!T):console.error("Project ref is required")},hasEditorValue:!!E,data:ec,error:ed,projectRef:f,onSelectedLogChange:et,selectedLog:q}),(0,t.jsx)("div",{className:"flex flex-row justify-end mt-2",children:(0,t.jsx)(D.default,{show:ex,setShowUpgradePrompt:ej})})]})})]}),(0,t.jsx)(J.Modal,{size:"medium",onCancel:()=>A(!T),header:"Save log query",visible:T,hideFooter:!0,children:(0,t.jsx)(W.Form,{initialValues:{name:"",desdcription:""},onSubmit:eb,children:()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(J.Modal.Content,{className:"space-y-6",children:[(0,t.jsx)(Y.Input,{layout:"horizontal",label:"Name",id:"name"}),(0,t.jsx)("div",{className:"text-area-text-sm",children:(0,t.jsx)(Y.Input.TextArea,{layout:"horizontal",labelOptional:"Optional",label:"Description",id:"description",rows:2})})]}),(0,t.jsx)(J.Modal.Separator,{}),(0,t.jsxs)(J.Modal.Content,{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(P.Button,{size:"tiny",type:"default",onClick:()=>A(!T),children:"Cancel"}),(0,t.jsx)(P.Button,{size:"tiny",loading:ef,disabled:ef,htmlType:"submit",children:"Save"})]})]})})})]})};et.getLayout=e=>(0,t.jsx)(F.default,{children:(0,t.jsx)(q.default,{children:e})}),e.s(["LogsExplorerPage",0,et,"default",0,et],982760)},394264,(e,t,s)=>{let r="/project/[ref]/logs/explorer";(window.__NEXT_P=window.__NEXT_P||[]).push([r,()=>e.r(982760)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([r])})},111410,e=>{e.v(t=>Promise.all(["static/chunks/a428d2b7e6671266.js","static/chunks/92a7c4be60dd12e3.js"].map(t=>e.l(t))).then(()=>t(677146)))},883471,e=>{e.v(t=>Promise.all(["static/chunks/69b2faaedd35af23.js"].map(t=>e.l(t))).then(()=>t(518769)))},587525,e=>{e.v(t=>Promise.all(["static/chunks/da2f61ca91d09b7f.js"].map(t=>e.l(t))).then(()=>t(127351)))},168845,e=>{e.v(t=>Promise.all(["static/chunks/99714db866f77205.js"].map(t=>e.l(t))).then(()=>t(238625)))},591393,e=>{e.v(t=>Promise.all(["static/chunks/e9ad074e72197584.js"].map(t=>e.l(t))).then(()=>t(217383)))},379416,e=>{e.v(t=>Promise.all(["static/chunks/d690909a90d04a2e.js"].map(t=>e.l(t))).then(()=>t(931066)))},15732,e=>{e.v(t=>Promise.all(["static/chunks/0d5256e667945be4.js"].map(t=>e.l(t))).then(()=>t(760545)))},957083,e=>{e.v(t=>Promise.all(["static/chunks/e7d07ff1ae210964.js"].map(t=>e.l(t))).then(()=>t(667558)))},207969,e=>{e.v(t=>Promise.all(["static/chunks/8dd7282c22f923f6.js"].map(t=>e.l(t))).then(()=>t(427328)))},992842,e=>{e.v(t=>Promise.all(["static/chunks/d064a48a1c7cf778.js"].map(t=>e.l(t))).then(()=>t(793794)))},239573,e=>{e.v(t=>Promise.all(["static/chunks/edc5d84148401903.js"].map(t=>e.l(t))).then(()=>t(210246)))},963685,e=>{e.v(t=>Promise.all(["static/chunks/92b20126e5ca0919.js"].map(t=>e.l(t))).then(()=>t(983756)))},665811,e=>{e.v(t=>Promise.all(["static/chunks/e37e25f8b82619ef.js"].map(t=>e.l(t))).then(()=>t(544836)))},369256,e=>{e.v(t=>Promise.all(["static/chunks/8296dc618dae72f0.js"].map(t=>e.l(t))).then(()=>t(930239)))},16037,e=>{e.v(t=>Promise.all(["static/chunks/3251b4bc539a554b.js"].map(t=>e.l(t))).then(()=>t(397698)))},616788,e=>{e.v(t=>Promise.all(["static/chunks/c6b81ab43a1d5d23.js"].map(t=>e.l(t))).then(()=>t(7346)))},315750,e=>{e.v(t=>Promise.all(["static/chunks/32c236321136eb7c.js"].map(t=>e.l(t))).then(()=>t(531289)))},460510,e=>{e.v(t=>Promise.all(["static/chunks/d91062943e6a7c30.js"].map(t=>e.l(t))).then(()=>t(276898)))},550265,e=>{e.v(t=>Promise.all(["static/chunks/75ff0e62b8a31d26.js"].map(t=>e.l(t))).then(()=>t(259714)))},830960,e=>{e.v(t=>Promise.all(["static/chunks/b44aa26556fee7df.js"].map(t=>e.l(t))).then(()=>t(882885)))},336744,e=>{e.v(t=>Promise.all(["static/chunks/2b0767b5c008139a.js"].map(t=>e.l(t))).then(()=>t(955268)))},63631,e=>{e.v(t=>Promise.all(["static/chunks/21a4706e1f02d90b.js"].map(t=>e.l(t))).then(()=>t(853630)))},912072,e=>{e.v(t=>Promise.all(["static/chunks/c17c80e5efc43419.js"].map(t=>e.l(t))).then(()=>t(311301)))},730314,e=>{e.v(t=>Promise.all(["static/chunks/dcadd9d46d72282e.js","static/chunks/810617c09317cd83.js","static/chunks/82dddbda1a808189.js","static/chunks/d3a06a9a43f3833e.js","static/chunks/87b9766a4d16d1da.js","static/chunks/cc8130a84ee9bc2c.css"].map(t=>e.l(t))).then(()=>t(686651)))}]);

//# debugId=ed532754-4275-776b-f7ea-2a238babd0a6
//# sourceMappingURL=6bf7087648d646d0.js.map