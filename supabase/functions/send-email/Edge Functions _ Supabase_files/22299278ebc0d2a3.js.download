;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="74742da2-c0be-80c1-eebd-477486cbf0ab")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,862326,e=>{"use strict";var t=e.i(478902),a=e.i(938933),r=e.i(843778);function s({children:e,className:a,tag:r="div",style:s}){let i=`${r}`;return(0,t.jsx)(i,{style:s,children:e})}s.Title=function({className:e,level:a=1,children:r,style:s}){let i=`h${a}`;return(0,t.jsx)(i,{style:s,children:r})},s.Text=function({className:e,children:a,style:r,type:s,disabled:i,mark:n,code:l,keyboard:o,underline:c,strikethrough:d,strong:u,small:m}){return l?(0,t.jsx)("code",{style:r,children:a}):n?(0,t.jsx)("mark",{style:r,children:a}):o?(0,t.jsx)("kbd",{style:r,children:a}):u?(0,t.jsx)("strong",{style:r,children:a}):(0,t.jsx)("span",{style:r,children:a})},s.Link=function({children:e,target:a="_blank",href:r,className:s,onClick:i,style:n}){return(0,t.jsx)("a",{onClick:i,href:r,target:a,rel:"noopener noreferrer",style:n,children:e})};var i=e.i(389959);let n=(0,i.createContext)({type:"text"}),l=e=>{let{type:a}=e;return(0,t.jsx)(n.Provider,{value:{type:a},children:e.children})},o=()=>{let e=(0,i.useContext)(n);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function c({children:e,className:a,ulClassName:r,style:s,type:i="text"}){return(0,t.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:a,style:s,children:(0,t.jsx)(l,{type:i,children:(0,t.jsx)("ul",{className:r,children:e})})})}c.Item=function({children:e,icon:s,active:i,rounded:n,onClick:l,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:u}){let m=(0,a.default)("menu"),{type:h}=o(),p=[m.item.base];p.push(m.item.variants[h].base),i?p.push(m.item.variants[h].active):p.push(m.item.variants[h].normal);let f=[m.item.content.base];i?f.push(m.item.content.active):f.push(m.item.content.normal);let g=[m.item.icon.base];return i?g.push(m.item.icon.active):g.push(m.item.icon.normal),(0,t.jsxs)("li",{role:"menuitem",className:(0,r.cn)("outline-none",p),style:u,onClick:l,"aria-current":i?"page":void 0,children:[s&&(0,t.jsx)("div",{className:`${g.join(" ")} min-w-fit`,children:s}),(0,t.jsx)("span",{className:f.join(" "),children:e})]})},c.Group=function({children:e,icon:r,title:s}){let i=(0,a.default)("menu"),{type:n}=o();return(0,t.jsxs)("div",{className:[i.group.base,i.group.variants[n]].join(" "),children:[r&&(0,t.jsx)("span",{className:i.group.icon,children:r}),(0,t.jsx)("span",{className:i.group.content,children:s}),e]})},c.Misc=function({children:e}){return(0,t.jsx)("div",{children:(0,t.jsx)(s.Text,{children:(0,t.jsx)("span",{children:e})})})},e.s(["Menu",0,c],862326)},3259,100387,e=>{"use strict";var t=e.i(478902),a=e.i(153545),r=e.i(933505);e.s(["ChevronRightIcon",()=>r.default],100387);var r=r,s=e.i(389959),i=e.i(843778);let n=s.forwardRef(({...e},a)=>(0,t.jsx)("nav",{ref:a,"aria-label":"breadcrumb",...e}));n.displayName="Breadcrumb";let l=s.forwardRef(({className:e,...a},r)=>(0,t.jsx)("ol",{ref:r,className:(0,i.cn)("flex flex-wrap items-center gap-0.5 break-words text-sm text-muted-foreground sm:gap-1.5",e),...a}));l.displayName="BreadcrumbList";let o=s.forwardRef(({className:e,...a},r)=>(0,t.jsx)("li",{ref:r,className:(0,i.cn)("inline-flex text-foreground-lighter items-center gap-1.5 leading-5",e),...a}));o.displayName="BreadcrumbItem";let c=s.forwardRef(({asChild:e,className:r,...s},n)=>{let l=e?a.Slot:"a";return(0,t.jsx)(l,{ref:n,className:(0,i.cn)("transition-colors underline lg:no-underline hover:text-foreground",r),...s})});c.displayName="BreadcrumbLink";let d=s.forwardRef(({className:e,...a},r)=>(0,t.jsx)("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:(0,i.cn)("no-underline text-foreground",e),...a}));d.displayName="BreadcrumbPage";let u=({children:e,className:a,...s})=>(0,t.jsx)("li",{role:"presentation","aria-hidden":"true",className:(0,i.cn)("[&>svg]:size-3.5 text-foreground-muted",a),...s,children:e??(0,t.jsx)(r.default,{})});u.displayName="BreadcrumbSeparator",e.s(["Breadcrumb",()=>n,"BreadcrumbItem",()=>o,"BreadcrumbLink",()=>c,"BreadcrumbList",()=>l,"BreadcrumbPage",()=>d,"BreadcrumbSeparator",()=>u],3259)},127739,e=>{"use strict";var t=e.i(478902),a=e.i(709520),r=e.i(389959),s=e.i(843778);let i=(0,a.cva)(["mx-auto w-full @container px-6 xl:px-10"],{variants:{size:{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}},defaultVariants:{size:"default"}}),n=(0,r.forwardRef)(({className:e,size:a,...r},n)=>(0,t.jsx)("div",{ref:n,...r,className:(0,s.cn)(i({size:a}),e)}));n.displayName="PageContainer",e.s(["PageContainer",0,n])},456050,e=>{"use strict";var t=e.i(478902),a=e.i(709520),r=e.i(389959),s=e.i(843778),i=e.i(3259),n=e.i(127739);let l=(0,a.cva)(["flex flex-col gap-4 w-full"],{variants:{size:{default:"pt-12",small:"pt-12",large:"pt-12",full:"pt-6"}},defaultVariants:{size:"default"}}),o=(0,r.createContext)({size:"default"}),c=()=>(0,r.useContext)(o),d=({className:e,size:a,children:r,...i})=>{let n=a??"default";return(0,t.jsx)(o.Provider,{value:{size:n},children:(0,t.jsx)("div",{"data-slot":"page-header","data-size":n,className:(0,s.cn)(l({size:n}),e),...i,children:r})})},u=({className:e,children:a,...r})=>{let{size:l}=c();return(0,t.jsx)(n.PageContainer,{size:l,children:(0,t.jsx)(i.Breadcrumb,{"data-slot":"page-header-breadcrumb",className:(0,s.cn)("flex items-center gap-4 [&_li]:text-xs",e),...r,children:a})})};u.displayName="PageHeaderBreadcrumb";let m=({className:e,...a})=>(0,t.jsx)("div",{"data-slot":"page-header-icon",className:(0,s.cn)("text-foreground-light",e),...a});m.displayName="PageHeaderIcon";let h=({className:e,children:a,...r})=>(0,t.jsx)("div",{"data-slot":"page-header-summary",className:(0,s.cn)("flex flex-col gap-1",e),...r,children:a});h.displayName="PageHeaderSummary";let p=({className:e,children:a,...r})=>(0,t.jsx)("h1",{"data-slot":"page-header-title",className:(0,s.cn)("heading-title",e),...r,children:a}),f=({className:e,children:a,...r})=>(0,t.jsx)("div",{"data-slot":"page-header-description",className:(0,s.cn)("heading-subSection text-foreground-light",e),...r,children:a}),g=({className:e,children:a,...r})=>{let{size:i}=c();return(0,t.jsx)(n.PageContainer,{size:i,children:(0,t.jsx)("div",{"data-slot":"page-header-meta",className:(0,s.cn)("flex flex-col @xl:flex-row @xl:justify-between @xl:items-center gap-4",'[&>[data-slot="page-header-icon"]]:shrink-0','[&>[data-slot="page-header-summary"]]:flex-1',e),...r,children:a})})};g.displayName="PageHeaderMeta";let x=({className:e,...a})=>(0,t.jsx)("div",{"data-slot":"page-header-actions",className:(0,s.cn)("flex items-center gap-2 shrink-0",e),...a});x.displayName="PageHeaderAside";let j=({className:e,...a})=>{let{size:r}=c();return(0,t.jsx)(n.PageContainer,{size:r,className:(0,s.cn)("full"===r&&"border-b"),children:(0,t.jsx)("div",{"data-slot":"page-header-footer",className:(0,s.cn)("w-full [&>nav]:border-b-0","full"!==r&&"border-b",e),...a})})};j.displayName="PageHeaderNavigationTabs",e.s(["PageHeader",()=>d,"PageHeaderAside",()=>x,"PageHeaderBreadcrumb",()=>u,"PageHeaderDescription",()=>f,"PageHeaderIcon",()=>m,"PageHeaderMeta",()=>g,"PageHeaderNavigationTabs",()=>j,"PageHeaderSummary",()=>h,"PageHeaderTitle",()=>p])},547723,e=>{"use strict";var t=e.i(478902),a=e.i(389959),r=e.i(843778);let s=(0,a.forwardRef)((e,a)=>(0,t.jsx)("nav",{ref:a,dir:"ltr",...e,className:(0,r.cn)("border-b",e.className),children:(0,t.jsx)("ul",{role:"menu",className:"flex gap-5",children:e.children})})),i=(0,a.forwardRef)(({children:e,className:a,active:s,...i},n)=>(0,t.jsx)("li",{ref:n,"aria-selected":s?"true":"false","data-state":s?"active":"inactive",className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap text-sm ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground text-foreground-lighter hover:text-foreground data-[state=active]:border-foreground border-b-2 border-transparent *:py-1.5",a),...i,children:e}));e.s(["NavMenu",0,s,"NavMenuItem",0,i])},12214,e=>{"use strict";var t=e.i(615515);let a=e=>Object.fromEntries(e.map(e=>e.split("=")));function r(e,t){if("wasm_fdw_handler"===e.handlerName){let r=a(t?.server_options??[]);return e.server.options.find(e=>"fdw_package_name"===e.name)?.defaultValue===r.fdw_package_name}return e.handlerName===t?.handler}function s(e){return t.WRAPPERS.find(t=>r(t,e))}e.s(["convertKVStringArrayToJson",0,a,"formatWrapperTables",0,(e,a)=>(e?.tables??[]).map(r=>{let s=0,i=Object.fromEntries(r.options.map(e=>e.split("=")));switch(e.handler){case t.WRAPPER_HANDLERS.STRIPE:s=a?.tables.findIndex(e=>e.options.find(e=>"object"===e.name)?.defaultValue===i.object)??0;break;case t.WRAPPER_HANDLERS.FIREBASE:s="auth/users"===i.object?a?.tables.findIndex(e=>e.options.find(e=>"auth/users"===e.defaultValue))??0:a?.tables.findIndex(e=>"Firestore Collection"===e.label)??0;case t.WRAPPER_HANDLERS.S3:case t.WRAPPER_HANDLERS.AIRTABLE:case t.WRAPPER_HANDLERS.LOGFLARE:case t.WRAPPER_HANDLERS.BIG_QUERY:case t.WRAPPER_HANDLERS.CLICK_HOUSE:}return{...i,index:s,id:r.id,columns:r.columns,is_new_schema:!1,schema:r.schema,schema_name:r.schema,table_name:r.name}}),"getWrapperMetaForWrapper",()=>s,"makeValidateRequired",0,e=>{let t=new Set(e.filter(e=>e.required).map(e=>e.name)),a=new Set(Array.from(t).filter(e=>e.includes("."))),r=Array.from(a);return e=>Object.fromEntries(Object.entries(e).flatMap(([e,t])=>Array.isArray(t)?[[e,t],...t.map((t,a)=>[`${e}.${a}`,t])]:[[e,t]]).filter(([e,s])=>{let[i,n]=e.split(".");if(void 0!==n&&t.has(i)&&Object.keys(s).some(e=>a.has(`${i}.${e}`))){let e=r.find(e=>e.startsWith(`${i}.`));return!!e&&!s[e.split(".")[1]]}return t.has(i)&&(Array.isArray(s)?s.length<1:!s)}).map(([e])=>"table_name"===e?[e,"Please provide a name for your table"]:"columns"===e?[e,"Please select at least one column"]:[e,"This field is required"]))},"wrapperMetaComparator",()=>r])},394983,228282,e=>{"use strict";var t=e.i(478902);let a=(0,e.i(388019).default)("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);e.s(["SquarePlus",()=>a],228282);var r=e.i(389959),s=e.i(843778);e.s(["EmptyStatePresentational",0,({icon:e,title:i,description:n,children:l,className:o,iconSize:c=24,iconClassName:d,contentClassName:u})=>{let m=e||a,h=(0,t.jsxs)("div",{className:(0,s.cn)("flex flex-col items-center text-center text-balance",u),children:[(0,t.jsx)("h3",{children:i}),n&&(0,t.jsx)("p",{className:"text-foreground-light text-sm max-w-[640px]",children:n})]});return(0,t.jsxs)("aside",{className:(0,s.cn)("border border-dashed w-full bg-surface-100 rounded-lg px-4 py-10 flex flex-col items-center gap-y-3",o),children:[(0,t.jsxs)("div",{className:"flex flex-col gap-y-3 items-center",children:[(0,r.isValidElement)(m)?m:"function"==typeof m||"object"==typeof m&&null!==m&&"$$typeof"in m?(0,r.createElement)(m,{size:c,strokeWidth:1.5,className:(0,s.cn)("text-foreground-muted",d)}):m,h]}),l]})}],394983)},302372,e=>{"use strict";var t=e.i(242882),a=e.i(248593),r=e.i(234745),s=e.i(635494);e.i(10429);var i=e.i(837508),n=e.i(509847);async function l({projectRef:e,connectionString:t,schema:s},i,n){if(!e)throw Error("projectRef is required");let l=new Headers(n);t&&l.set("x-connection-encrypted",t);let{data:o,error:c}=await (0,r.get)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":t,"x-pg-application-name":a.DEFAULT_PLATFORM_APPLICATION_NAME},path:{ref:e},query:{included_schemas:s||"",excluded_schemas:""}},headers:l,signal:i});return c&&(0,r.handleError)(c),o}e.s(["useDatabasePoliciesQuery",0,({projectRef:e,connectionString:a,schema:r},{enabled:o=!0,...c}={})=>{let{data:d}=(0,s.useSelectedProjectQuery)(),u=d?.status===i.PROJECT_STATUS.ACTIVE_HEALTHY;return(0,t.useQuery)({queryKey:n.databasePoliciesKeys.list(e,r),queryFn:({signal:t})=>l({projectRef:e,connectionString:a,schema:r},t),enabled:o&&void 0!==e&&u,...c})}])},886514,e=>{"use strict";let t=(0,e.i(388019).default)("ArrowDownNarrowWide",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h4",key:"6d7r33"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h10",key:"1438ji"}]]);e.s(["ArrowDownNarrowWide",()=>t],886514)},863946,(e,t,a)=>{var r=e.r(196047),s=e.r(113619),i=e.r(744040),n=e.r(70234),l=e.r(389239),o=e.r(233037);t.exports=function(e,t,a,c){var d=-1,u=s,m=!0,h=e.length,p=[],f=t.length;if(!h)return p;a&&(t=n(t,l(a))),c?(u=i,m=!1):t.length>=200&&(u=o,m=!1,t=new r(t));e:for(;++d<h;){var g=e[d],x=null==a?g:a(g);if(g=c||0!==g?g:0,m&&x==x){for(var j=f;j--;)if(t[j]===x)continue e;p.push(g)}else u(t,x,c)||p.push(g)}return p}},667954,742578,e=>{"use strict";e.i(967533);var t=e.i(977540),a=e.i(242882),r=e.i(714403);let s={list:e=>["projects",e,"secrets"],getDecryptedValue:(e,t)=>["projects",e,"secrets",t]};e.s(["vaultSecretsKeys",0,s],742578);let i=async({projectRef:e,connectionString:a,id:i},n)=>{let l=new t.Query().from("decrypted_secrets","vault").select("decrypted_secret").match({id:i}).toSql(),{result:o}=await (0,r.executeSql)({projectRef:e,connectionString:a,sql:l,queryKey:s.getDecryptedValue(e,i)},n);return o},n=async({projectRef:e,connectionString:a,ids:s},i)=>{let n=new t.Query().from("decrypted_secrets","vault").select("id,decrypted_secret").filter("id","in",s).toSql(),{result:l}=await (0,r.executeSql)({projectRef:e,connectionString:a,sql:n},i);return l.reduce((e,t)=>({...e,[t.id]:t.decrypted_secret}),{})};e.s(["getDecryptedValue",0,i,"getDecryptedValues",0,n,"useVaultSecretDecryptedValueQuery",0,({projectRef:e,connectionString:t,id:r},{enabled:n=!0,...l}={})=>(0,a.useQuery)({queryKey:s.getDecryptedValue(e,r),queryFn:({signal:a})=>i({projectRef:e,connectionString:t,id:r},a),select:e=>e[0]?.decrypted_secret??"",enabled:n&&void 0!==e&&void 0!==r,...l})],667954)},25862,e=>{"use strict";var t=e.i(242882),a=e.i(234745),r=e.i(10429),s=e.i(78162);async function i({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:r,error:s}=await (0,a.get)("/platform/projects/{ref}/config/storage",{params:{path:{ref:e}},signal:t});return s&&(404===s.code?(0,a.handleError)({...s,message:"Storage configuration not found."}):(0,a.handleError)(s)),r}let n=({projectRef:e},{enabled:a=!0,...n}={})=>(0,t.useQuery)({queryKey:s.configKeys.storage(e),queryFn:({signal:t})=>i({projectRef:e},t),enabled:a&&r.IS_PLATFORM&&void 0!==e,...n});e.s(["useIsAnalyticsBucketsEnabled",0,({projectRef:e})=>{let{data:t}=n({projectRef:e});return!!t?.features.icebergCatalog?.enabled},"useIsVectorBucketsEnabled",0,({projectRef:e})=>{let{data:t}=n({projectRef:e});return!!t?.features.vectorBuckets?.enabled},"useProjectStorageConfigQuery",0,n])},889594,(e,t,a)=>{var r=e.r(863946),s=e.r(730007),i=e.r(380487),n=e.r(583755);t.exports=i(function(e,t){return n(e)?r(e,s(t,1,n,!0)):[]})},319941,209636,e=>{"use strict";var t=e.i(889594),a=e.i(898452),r=e.i(12214),s=e.i(667954),i=e.i(48189),n=e.i(890265);let l=e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return new Uint32Array([t])[0].toString(36)},o=(0,i.createWrappedSymbol)("unknown-bucket","Unknown"),c=(0,i.createWrappedSymbol)("ungrouped-policy","Ungrouped"),d=e=>{if(!e)return null;let[t]=(e?.split(" AND ")??[]).filter(e=>e.includes("bucket_id"));return t?t.split("'")[1]:null},u=()=>(0,a.useRouter)().pathname.split("/")[4],m=async({ref:e,connectionString:t,wrapper:a,wrapperMeta:i})=>{let n=i.server.options,l=(0,r.convertKVStringArrayToJson)(a?.server_options??[]),o=Object.fromEntries(new Map(Object.entries(l).filter(([e,t])=>n.find(t=>t.name===e)?.encrypted))),c=await (0,s.getDecryptedValues)({projectRef:e,connectionString:t,ids:Object.values(o)}),d=Object.fromEntries(new Map(Object.entries(o).map(([e,t])=>[e,c[t]])));return{...l,...d}};e.s(["UNGROUPED_POLICY_SYMBOL",0,c,"applyBucketIdToTemplateDefinition",0,(e,t)=>e.replace("{bucket_id}",`'${t}'`),"createPayloadsForAddPolicy",0,(e="",t,a=!0)=>{let{name:r,definition:s,allowedOperations:i,roles:n}=t,o=s?s.replace(/\s+/g," ").trim():"";return i.map((t,s)=>{var i,c,d,u,m,h,p;let f;return i=s,c=e,d=r,u=o,m=t,h=n,p=a,f=l(c),{name:p?`${d} ${f}_${i}`:d,definition:"INSERT"===m?void 0:`(${u})`,action:"PERMISSIVE",check:"INSERT"===m?`(${u})`:void 0,command:m,schema:"storage",table:"objects",roles:h.length>0?h:void 0}})},"createSQLPolicies",0,(e,t,a=!0)=>{let{name:r,definition:s,allowedOperations:i,roles:n}=t;return i.map((t,i)=>{var o;let c,d,u,m;return o=s||"",c=l(e),d=a?`${r} ${c}_${i}`:r,u=`Add policy for the ${t} operation under the policy "${r}"`,m=0===n.length?["public"]:n,{description:u,statement:`
    CREATE POLICY "${d}"
    ON storage.objects
    FOR ${t}
    TO ${m.join(", ")}
    ${"INSERT"===t?"WITH CHECK":"USING"} (${o});
`.replace(/\s+/g," ").trim()}})},"deriveAllowedClientLibraryMethods",0,(e=[])=>Object.keys(n.STORAGE_CLIENT_LIBRARY_MAPPINGS).filter(a=>{let r=n.STORAGE_CLIENT_LIBRARY_MAPPINGS[a];if(0===(0,t.default)(r,e).length)return a}),"extractBucketNameFromDefinition",0,d,"formatPoliciesForStorage",0,(e,t)=>{var a,r,s;let i,n;return 0===t.length?[]:(s=(a=e,r=t,i=a.map(e=>e.name),r.map(e=>{let{definition:t,check:a}=e,r=null!==t?d(t):d(a);if(r){let t=i.includes(r);return{...e,bucket:t?r:o}}return{...e,bucket:c}})),n=new Map,s.forEach(e=>{n.has(e.bucket)||n.set(e.bucket,[]),n.get(e.bucket)?.push(e)}),[...n.entries().map(([e,t])=>({name:e,policies:t}))])},"getDecryptedParameters",0,m,"useStorageV2Page",0,u],319941);var h=e.i(478902),p=e.i(215261);e.i(128328);var f=e.i(86086),g=e.i(158639),x=e.i(25862),j=e.i(912793),b=e.i(587433),y=e.i(862326);let _=()=>{let{ref:e}=(0,g.useParams)(),t=u(),{storageAnalytics:a,storageVectors:r}=(0,j.useIsFeatureEnabled)(["storage:analytics","storage:vectors"]),s=(0,x.useIsAnalyticsBucketsEnabled)({projectRef:e}),i=(0,x.useIsVectorBucketsEnabled)({projectRef:e}),l=Object.entries(n.BUCKET_TYPES).filter(([e])=>"analytics"===e?f.IS_PLATFORM&&a:"vectors"!==e||f.IS_PLATFORM&&r);return(0,h.jsx)(y.Menu,{type:"pills",className:"my-6 flex flex-grow flex-col",children:(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"mx-3",children:[(0,h.jsx)(y.Menu.Group,{title:(0,h.jsx)("span",{className:"uppercase font-mono",children:"Manage"})}),l.map(([a,r])=>(0,h.jsx)(p.default,{href:`/project/${e}/storage/${a}`,children:(0,h.jsx)(y.Menu.Item,{rounded:!0,active:t===a,children:(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)("p",{className:"truncate",children:r.displayName}),("analytics"===a&&s||"vectors"===a&&i)&&(0,h.jsx)(b.Badge,{variant:"success",children:"New"})]})})},a))]}),f.IS_PLATFORM&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"h-px w-full bg-border"}),(0,h.jsxs)("div",{className:"mx-3",children:[(0,h.jsx)(y.Menu.Group,{title:(0,h.jsx)("span",{className:"uppercase font-mono",children:"Configuration"})}),(0,h.jsx)(p.default,{href:`/project/${e}/storage/s3`,children:(0,h.jsx)(y.Menu.Item,{rounded:!0,active:"s3"===t,children:(0,h.jsx)("p",{className:"truncate",children:"S3"})})})]})]})]})})};var v=e.i(951138),S=e.i(825713);let k=(0,v.withAuth)(({title:e,children:t})=>(0,h.jsx)(S.ProjectLayout,{title:e||"Storage",product:"Storage",productMenu:(0,h.jsx)(_,{}),children:t}));e.s(["default",0,k],209636)},904987,e=>{"use strict";var t=e.i(478902),a=e.i(215261);e.i(128328);var r=e.i(158639),s=e.i(890265),i=e.i(319941),n=e.i(513826),l=e.i(95051),o=e.i(547723),c=e.i(456050);e.s(["StorageBucketsLayout",0,({title:e,hideSubtitle:d=!1,children:u})=>{let{ref:m}=(0,r.useParams)(),h=(0,l.usePathname)(),p=(0,i.useStorageV2Page)(),f=p&&"s3"!==p?s.BUCKET_TYPES[p]:void 0,g="files"===p?[{label:"Buckets",href:`/project/${m}/storage/files`},{label:"Settings",href:`/project/${m}/storage/files/settings`},{label:"Policies",href:`/project/${m}/storage/files/policies`}]:[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(c.PageHeader,{children:[(0,t.jsxs)(c.PageHeaderMeta,{children:[(0,t.jsxs)(c.PageHeaderSummary,{children:[(0,t.jsx)(c.PageHeaderTitle,{children:e||(f?.displayName??"Storage")}),!d&&(0,t.jsx)(c.PageHeaderDescription,{children:f?.description||"Manage your storage buckets and files."})]}),(0,t.jsx)(c.PageHeaderAside,{children:f?.docsUrl&&(0,t.jsx)(n.DocsButton,{href:f.docsUrl},"docs")})]}),g.length>0&&(0,t.jsx)(c.PageHeaderNavigationTabs,{children:(0,t.jsx)(o.NavMenu,{children:g.map(e=>(0,t.jsx)(o.NavMenuItem,{active:h===e.href,children:(0,t.jsx)(a.default,{href:e.href,children:e.label})},e.label))})})]}),u]})}])},608907,572349,e=>{"use strict";var t=e.i(478902);e.i(481541);var a=e.i(129449),a=a,r=e.i(394983),s=e.i(902858),i=e.i(479232),n=e.i(215312),l=e.i(2579);let o=({onClick:e})=>{let{can:a}=(0,l.useAsyncCheckPermissions)(s.PermissionAction.STORAGE_WRITE,"*");return(0,t.jsx)(n.ButtonTooltip,{block:!0,size:"tiny",type:"primary",className:"w-fit",icon:(0,t.jsx)(i.Plus,{size:14}),disabled:!a,onClick:e,tooltip:{content:{side:"bottom",text:a?void 0:"You need additional permissions to create buckets"}},children:"New bucket"})};e.s(["CreateBucketButton",0,o],572349);var c=e.i(890265);e.s(["EmptyBucketState",0,({bucketType:e,className:s,onCreateBucket:i})=>{let n=c.BUCKET_TYPES[e];return(0,t.jsx)(r.EmptyStatePresentational,{icon:a.default,title:`Create ${n.article} ${n.singularName} bucket`,description:n.valueProp,className:s,children:(0,t.jsx)(o,{onClick:i})})}],608907)},477671,e=>{"use strict";var t=e.i(900843);e.s(["FilesBucket",()=>t.default])},42081,e=>{"use strict";let t="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;e.s(["DEBUG_BUILD",()=>t])},657938,e=>{"use strict";var t=e.i(319941),a=e.i(302372),r=e.i(34231),s=e.i(635494);e.s(["useBucketPolicyCount",0,()=>{let{data:e,isPending:i}=(0,s.useSelectedProjectQuery)(),{data:n=[],isPending:l}=(0,r.useBucketsQuery)({projectRef:e?.ref}),{data:o=[],isPending:c}=(0,a.useDatabasePoliciesQuery)({projectRef:e?.ref,connectionString:e?.connectionString,schema:"storage"}),d=o.filter(e=>"objects"===e.table),u=(0,t.formatPoliciesForStorage)(n,d);return{getPolicyCount:e=>u.find(t=>t.name===e)?.policies.length??0,isLoading:i||l||c}}])},672296,e=>{"use strict";function t(e){return e.split("#")[0]}function a(e,t={}){let{maxDepth:r=3,redaction:s="[REDACTED]",truncationNotice:i="[REDACTED: max depth reached]",sensitiveKeys:n=[]}=t,l=new Set(["password","passwd","pwd","pass","secret","token","id_token","access_token","refresh_token","apikey","api_key","api-key","apiKey","key","privatekey","private_key","client_secret","clientSecret","auth","authorization","ssh_key","sshKey","bearer","session","cookie","csrf","xsrf","ip","ip_address","ipAddress","aws_access_key_id","aws_secret_access_key","gcp_service_account_key",...n].map(e=>e.toLowerCase())),o=[{re:/\b(?:(?:25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|1?\d?\d)\b/g,reason:"ip"},{re:/\b(?:[A-Fa-f0-9]{1,4}:){2,7}[A-Fa-f0-9]{1,4}\b/g,reason:"ip6"},{re:/\b(AKI|ASI)A[0-9A-Z]{16}\b/g,reason:"aws_access_key_id"},{re:/\b[0-9A-Za-z/+]{40}\b/g,reason:"aws_secret_access_key_like"},{re:/\bBearer\s+[A-Za-z0-9\-._~+/]+=*\b/g,reason:"bearer"},{re:/\b[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\b/g,reason:"jwt_like"},{re:/\b[A-Za-z0-9_\-]{24,64}\b/g,reason:"long_token"}],c=new WeakMap;function d(e){let t=e;for(let{re:e}of o)t=t.replace(e,s);return t}function u(e){return l.has(String(e).toLowerCase())}return e.map(e=>(function e(t,a){if(null==t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t;if("string"==typeof t)return d(t);if("function"==typeof t)return"[Function]";if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return t.toString();if(ArrayBuffer.isView(t)&&!(t instanceof DataView))return`[TypedArray byteLength=${t.byteLength}]`;if(t instanceof ArrayBuffer)return`[ArrayBuffer byteLength=${t.byteLength}]`;if(a>=r)return i;if("object"==typeof t){if(c.has(t))return"[Circular]";if(Array.isArray(t)){let r=[];c.set(t,r);for(let s=0;s<t.length;s++)r[s]=e(t[s],a+1);return r}if(function(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}(t)){let r={};for(let[i,n]of(c.set(t,r),Object.entries(t)))u(i)?r[i]=s:r[i]=e(n,a+1);return r}if(t instanceof Map){let r=[];for(let[i,n]of(c.set(t,r),t.entries())){let t=u(i)?s:e(i,a+1),l=u(i)?s:e(n,a+1);r.push([t,l])}return r}if(t instanceof Set){let r=[];for(let s of(c.set(t,r),t.values()))r.push(e(s,a+1));return r}if(t instanceof URL)return t.toString();if(t instanceof Error){let e={name:t.name,message:d(t.message),stack:i};return c.set(t,e),e}try{return d(String(t))}catch{return d(Object.prototype.toString.call(t))}}return d(String(t))})(e,0))}e.s(["sanitizeArrayOfObjects",()=>a,"sanitizeUrlHashParams",()=>t])},936919,e=>{"use strict";var t=e.i(478902),a=e.i(202584),r=e.i(886514),s=e.i(366652),i=e.i(389959);e.i(128328);var n=e.i(158639),l=e.i(567558),o=e.i(937942),c=e.i(642834),d=e.i(25862),u=e.i(34231),m=e.i(10429),h=e.i(48189),p=e.i(4196),f=e.i(884346),g=e.i(837710),x=e.i(627069),j=e.i(874311),b=e.i(710483),y=e.i(746301),_=e.i(127739),v=e.i(228027),S=e.i(532728),k=e.i(408891),w=e.i(355901),P=e.i(417403),N=e.i(870354),A=e.i(38429),R=e.i(356003),C=e.i(234745),E=e.i(937163);async function T({projectRef:e,id:t,type:a,isPublic:r,file_size_limit:s,allowed_mime_types:i}){if(!e)throw Error("projectRef is required");if(!t)throw Error("Bucket name is required");let n={id:t,type:a,public:r};"STANDARD"===a&&(s&&(n.file_size_limit=s),i&&(n.allowed_mime_types=i));let{data:l,error:o}=await (0,C.post)("/platform/storage/{ref}/buckets",{params:{path:{ref:e}},body:n});return o&&(0,C.handleError)(o),l}var I=e.i(162082),B=e.i(265735),z=e.i(253214),M=e.i(428353),L=e.i(24315),D=e.i(61863),F=e.i(846887),O=e.i(378277),$=e.i(449123),H=e.i(451031),U=e.i(831927),V=e.i(156722),K=e.i(719754),q=e.i(290811),G=e.i(538482),W=e.i(275226),Q=e.i(146217);let Y=P.default.object({name:P.default.string().trim().min(1,"Please provide a name for your bucket").max(100,"Bucket name should be below 100 characters").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name'),public:P.default.boolean().default(!1),has_file_size_limit:P.default.boolean().default(!1),formatted_size_limit:P.default.coerce.number().min(0,"File size upload limit has to be at least 0").optional(),allowed_mime_types:P.default.string().trim().default("")}).superRefine((e,t)=>{if(!W.validBucketNameRegex.test(e.name)){let[a]=e.name.match(W.inverseValidBucketNameRegex)??[];t.addIssue({path:["name"],code:P.default.ZodIssueCode.custom,message:a?`Bucket name cannot contain the "${a}" character`:"Bucket name contains an invalid special character"})}}),Z="create-storage-bucket-form",J=({open:e,onOpenChange:a})=>{let{ref:r}=(0,n.useParams)(),{data:s}=(0,B.useSelectedOrganizationQuery)(),[l,c]=(0,i.useState)(N.StorageSizeUnits.MB),[u,h]=(0,i.useState)(!1),{data:p}=(0,d.useProjectStorageConfigQuery)({projectRef:r},{enabled:m.IS_PLATFORM}),{value:f,unit:x}=(0,Q.convertFromBytes)(p?.fileSizeLimit??0),j=`${f} ${x}`,{mutate:y}=(0,I.useSendEventMutation)(),{mutateAsync:_,isPending:v}=(({onSuccess:e,onError:t,...a}={})=>{let r=(0,R.useQueryClient)();return(0,A.useMutation)({mutationFn:e=>T(e),async onSuccess(t,a,s){let{projectRef:i}=a;await r.invalidateQueries({queryKey:E.storageKeys.buckets(i)}),await e?.(t,a,s)},async onError(e,a,r){void 0===t?w.toast.error(`Failed to create bucket: ${e.message}`):t(e,a,r)},...a})})({onError:()=>{}}),P=(0,k.useForm)({resolver:(0,S.zodResolver)(Y),defaultValues:{name:"",public:!1,has_file_size_limit:!1,formatted_size_limit:void 0,allowed_mime_types:""}}),{formatted_size_limit:C}=P.formState.errors,W=P.watch("public"),J=P.watch("has_file_size_limit"),X=async e=>{if(!r)return console.error("Project ref is required");try{let t=e.has_file_size_limit&&void 0!==e.formatted_size_limit?(0,Q.convertToBytes)(e.formatted_size_limit,l):void 0,i=u&&e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):void 0;if(t&&p?.fileSizeLimit&&t>p.fileSizeLimit)return P.setError("formatted_size_limit",{type:"manual",message:"exceed_global_limit"});await _({projectRef:r,id:e.name,type:"STANDARD",isPublic:e.public,file_size_limit:t,allowed_mime_types:i}),y({action:"storage_bucket_created",properties:{bucketType:"STANDARD"},groups:{project:r??"Unknown",organization:s?.slug??"Unknown"}}),w.toast.success(`Successfully created bucket ${e.name}`),P.reset(),c(N.StorageSizeUnits.MB),a(!1)}catch(t){let e=t.message?.toLowerCase()||"";e.includes("mime type")&&(e.includes("is not supported")||e.includes("not supported"))?P.setError("allowed_mime_types",{type:"manual",message:"Invalid MIME type format. Please check your input."}):w.toast.error(`Failed to create bucket: ${t.message}`)}};return(0,t.jsx)(z.Dialog,{open:e,onOpenChange:e=>{e||(P.reset(),c(N.StorageSizeUnits.MB),a(!1))},children:(0,t.jsxs)(z.DialogContent,{"aria-describedby":void 0,children:[(0,t.jsx)(z.DialogHeader,{children:(0,t.jsx)(z.DialogTitle,{children:"Create file bucket"})}),(0,t.jsx)(z.DialogSectionSeparator,{}),(0,t.jsx)(M.Form_Shadcn_,{...P,children:(0,t.jsxs)("form",{id:Z,onSubmit:P.handleSubmit(X),children:[(0,t.jsx)(z.DialogSection,{className:"flex flex-col gap-y-2",children:(0,t.jsx)(D.FormField_Shadcn_,{name:"name",control:P.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{name:"name",label:"Bucket name",labelOptional:"Cannot be changed after creation",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(O.Input_Shadcn_,{id:"name","data-1p-ignore":!0,"data-lpignore":"true","data-form-type":"other","data-bwignore":!0,...e,placeholder:"Enter bucket name"})})})},"name")}),(0,t.jsx)(z.DialogSectionSeparator,{}),(0,t.jsxs)(z.DialogSection,{className:"space-y-3",children:[(0,t.jsx)(D.FormField_Shadcn_,{name:"public",control:P.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{hideMessage:!0,name:"public",label:"Public bucket",description:"Allow anyone to read objects without authorization",layout:"flex",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(q.Switch,{id:"public",size:"large",checked:e.value,onCheckedChange:e.onChange})})})},"public"),W&&(0,t.jsx)(b.Admonition,{type:"warning",title:"Public buckets are not protected",description:"Users can read objects in public buckets without any authorization. Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]}),(0,t.jsx)(z.DialogSectionSeparator,{}),(0,t.jsxs)(z.DialogSection,{className:"space-y-2",children:[(0,t.jsx)(D.FormField_Shadcn_,{name:"has_file_size_limit",control:P.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{name:"has_file_size_limit",label:"Restrict file size",description:"Prevent uploading of files larger than a specified limit",layout:"flex",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(q.Switch,{id:"has_file_size_limit",size:"large",checked:e.value,onCheckedChange:e.onChange})})})},"has_file_size_limit"),J&&(0,t.jsxs)("div",{children:[(0,t.jsx)(D.FormField_Shadcn_,{name:"formatted_size_limit",control:P.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{hideMessage:!0,name:"formatted_size_limit",label:"File size limit",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-x-2",children:[(0,t.jsx)("div",{className:"col-span-8",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(O.Input_Shadcn_,{id:"formatted_size_limit","aria-label":"File size limit",type:"number",min:0,placeholder:"0",...e})})}),(0,t.jsx)("div",{className:"col-span-4",children:(0,t.jsxs)($.Select_Shadcn_,{value:l,onValueChange:c,children:[(0,t.jsx)(V.SelectTrigger_Shadcn_,{"aria-label":"File size limit unit",size:"small",children:(0,t.jsx)(K.SelectValue_Shadcn_,{children:l})}),(0,t.jsx)(H.SelectContent_Shadcn_,{children:Object.values(N.StorageSizeUnits).map(e=>(0,t.jsx)(U.SelectItem_Shadcn_,{value:e,className:"text-xs",children:e},e))})]})})]})})},"formatted_size_limit"),C?.message==="exceed_global_limit"&&(0,t.jsxs)(F.FormMessage_Shadcn_,{className:"mt-2",children:["Exceeds global limit of ",j,". Increase limit in"," ",(0,t.jsx)(o.InlineLink,{className:"text-destructive decoration-destructive-500 hover:decoration-destructive",href:`/project/${r}/storage/settings`,onClick:()=>a(!1),children:"Storage Settings"})," ","first."]}),m.IS_PLATFORM&&(0,t.jsxs)("p",{className:"text-sm text-foreground-lighter mt-2",children:["This project has a"," ",(0,t.jsx)(o.InlineLink,{className:"text-foreground-light hover:text-foreground",href:`/project/${r}/storage/settings`,onClick:()=>a(!1),children:"global file size limit"})," ","of ",j,"."]})]})]}),(0,t.jsx)(z.DialogSectionSeparator,{}),(0,t.jsxs)(z.DialogSection,{className:"space-y-2",children:[(0,t.jsx)(G.FormItemLayout,{name:"has_allowed_mime_types",label:"Restrict MIME types",description:"Allow only certain types of files to be uploaded",layout:"flex",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(q.Switch,{id:"has_allowed_mime_types",size:"large",checked:u,onCheckedChange:h})})}),u&&(0,t.jsx)(D.FormField_Shadcn_,{name:"allowed_mime_types",control:P.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{name:"allowed_mime_types",label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*.",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(O.Input_Shadcn_,{id:"allowed_mime_types",...e,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})},"allowed_mime_types")]})]})}),(0,t.jsxs)(z.DialogFooter,{children:[(0,t.jsx)(g.Button,{type:"default",disabled:v,onClick:()=>a(!1),children:"Cancel"}),(0,t.jsx)(g.Button,{form:Z,htmlType:"submit",loading:v,disabled:v,children:"Create"})]})]})})};var X=e.i(608907),ee=e.i(572349),et=e.i(890265),ea=e.i(431810),er=e.i(117672),es=e.i(843778),ei=e.i(492418);let en=(0,i.createContext)(null),el=({scrollContainerProps:e,scrollContainerRef:a,containerProps:r,data:s,children:n,overscan:l=5,estimateSize:o,getItemKey:c,...d})=>{let u=(0,i.useRef)(null),m=(0,er.mergeRefs)(u,a),h=(0,i.useCallback)((e,t)=>c?c(e,t):t,[c]),p=(0,i.useCallback)(e=>{let t=s[e];return t?h(t,e):e},[s,h]),f=(0,ea.useVirtualizer)({count:s.length,getScrollElement:()=>u.current,overscan:l,estimateSize:o,getItemKey:p}),g=f.getVirtualItems(),x=f.getTotalSize(),j=g.length>0?g[0].start:0,b=g.length>0?x-g[g.length-1].end:0,y=(0,i.useMemo)(()=>({virtualizer:f,virtualItems:g,data:s,paddingTop:j,paddingBottom:b,getRowKey:h}),[f,g,s,j,b,h]),_=(0,i.useMemo)(()=>({...r,className:(0,es.cn)("overflow-visible",r?.className)}),[r]),{className:v,...S}=e??{};return(0,t.jsx)("div",{ref:m,className:(0,es.cn)("h-full overflow-auto",v),...S,children:(0,t.jsx)(en.Provider,{value:y,children:(0,t.jsx)(ei.Table,{containerProps:_,...d,children:n})})})},eo=({emptyContent:e,leadingContent:a,trailingContent:r,children:s,paddingColSpan:n=1,paddingCellClassName:l,...o})=>{let{virtualizer:c,virtualItems:d,data:u,paddingTop:m,paddingBottom:h,getRowKey:p}=(()=>{let e=(0,i.useContext)(en);if(!e)throw Error("VirtualizedTable components must be used within a VirtualizedTable");return e})(),f=c.measureElement;return(0,t.jsxs)(ei.TableBody,{...o,children:[a,0===u.length?e??null:(0,t.jsxs)(t.Fragment,{children:[m>0&&(0,t.jsx)(ei.TableRow,{"aria-hidden":"true",style:{height:m},children:(0,t.jsx)(em,{colSpan:n,className:(0,es.cn)("p-0",l)})}),d.map(e=>{let t=u[e.index];if(void 0===t)return null;let a=s(t,e.index);if(!(0,i.isValidElement)(a))return a;let r=a.key??p(t,e.index),n=a.ref,l=null!=n?(0,er.mergeRefs)(f,n):f;return(0,i.cloneElement)(a,{key:r,ref:l,"data-index":e.index})}),h>0&&(0,t.jsx)(ei.TableRow,{"aria-hidden":"true",style:{height:h},children:(0,t.jsx)(em,{colSpan:n,className:(0,es.cn)("p-0",l)})})]}),r]})},ec=ei.TableHeader,ed=(0,i.forwardRef)(({className:e,...a},r)=>(0,t.jsx)(ei.TableHead,{ref:r,className:(0,es.cn)("sticky top-0 z-10 bg-200",e),...a}));ed.displayName="VirtualizedTableHead";let eu=ei.TableRow,em=ei.TableCell;ei.TableFooter,ei.TableCaption;var eh=e.i(657938);e.i(481541);var ep=e.i(477671),ef=e.i(416050),eg=e.i(95051),ex=e.i(587433);let ej=({mode:e,hasBuckets:a=!0})=>{let r="standard"===e?ei.TableHeader:ec,s="standard"===e?ei.TableRow:eu,i="standard"===e?ei.TableHead:ed,n="sticky top-0 z-10 bg-200";return(0,t.jsx)(r,{children:(0,t.jsxs)(s,{children:[a&&(0,t.jsx)(i,{className:`${n} w-2 pr-1`,children:(0,t.jsx)("span",{className:"sr-only",children:"Icon"})}),(0,t.jsx)(i,{className:n,children:"Name"}),(0,t.jsx)(i,{className:n,children:"Policies"}),(0,t.jsx)(i,{className:n,children:"File size limit"}),(0,t.jsx)(i,{className:n,children:"Allowed MIME types"}),(0,t.jsx)(i,{className:n,children:(0,t.jsx)("span",{className:"sr-only",children:"Actions"})})]})})},eb=({mode:e,filterString:a})=>{let r="standard"===e?ei.TableRow:eu,s="standard"===e?ei.TableCell:em;return(0,t.jsx)(r,{className:"[&>td]:hover:bg-inherit",children:(0,t.jsxs)(s,{colSpan:5,children:[(0,t.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,t.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Your search for “",a,"” did not return any results"]})]})})},ey=({mode:e,bucket:a,projectRef:r,formattedGlobalUploadLimit:s})=>{let i=(0,eg.useRouter)(),{getPolicyCount:n}=(0,eh.useBucketPolicyCount)(),l="standard"===e?ei.TableRow:eu,o="standard"===e?ei.TableCell:em,c=(e,t)=>{let a=`/project/${r}/storage/files/buckets/${encodeURIComponent(e)}`;t.metaKey||t.ctrlKey?window.open(`${m.BASE_PATH}${a}`,"_blank"):i.push(a)};return(0,t.jsxs)(l,{"data-bucket-id":a.id,className:"relative cursor-pointer h-16 group inset-focus",onClick:e=>c(a.id,e),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c(a.id,e))},tabIndex:0,children:[(0,t.jsx)(o,{className:"w-2 pr-1",children:(0,t.jsx)(ep.FilesBucket,{"aria-label":"bucket icon",size:16,className:"text-foreground-muted"})}),(0,t.jsx)(o,{className:"flex-1",children:(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("p",{className:"whitespace-nowrap max-w-[512px] truncate",children:a.id}),a.public&&(0,t.jsx)(ex.Badge,{variant:"warning",children:"Public"})]})}),(0,t.jsx)(o,{children:(0,t.jsx)("p",{className:"text-foreground-light",children:n(a.id)})}),(0,t.jsx)(o,{children:(0,t.jsx)("p",{className:`whitespace-nowrap ${a.file_size_limit?"text-foreground-light":"text-foreground-muted"}`,children:a.file_size_limit?(0,h.formatBytes)(a.file_size_limit):`Unset (${s})`})}),(0,t.jsx)(o,{children:(0,t.jsx)("p",{className:a.allowed_mime_types?"text-foreground-light":"text-foreground-muted",children:a.allowed_mime_types?a.allowed_mime_types.join(", "):"Any"})}),(0,t.jsxs)(o,{children:[(0,t.jsx)("div",{className:"flex justify-end items-center h-full",children:(0,t.jsx)(ef.ChevronRight,{"aria-hidden":!0,size:14,className:"text-foreground-muted/60"})}),(0,t.jsx)("button",{tabIndex:-1,className:"sr-only",children:"Go to bucket details"})]})]},a.id)};var e_=e.i(108151);let ev=({mode:e,colSpan:r,hasMore:s=!1,isLoadingMore:n=!1,onLoadMore:l})=>{let[o,c]=(0,a.useIntersectionObserver)({threshold:0,rootMargin:"200px 0px 200px 0px"});if((0,i.useEffect)(()=>{c?.isIntersecting&&s&&!n&&l?.()},[c?.isIntersecting,s,n,l]),!s&&!n)return null;let d="standard"===e?ei.TableRow:eu,u="standard"===e?ei.TableCell:em;return(0,t.jsx)(d,{ref:o,children:Array.from({length:r},(e,a)=>(0,t.jsx)(u,{children:0!==a&&a!==r-1&&(0,t.jsx)(e_.ShimmeringLoader,{className:"w-3/4"})},a))})},eS=e=>e.buckets.length>50?(0,t.jsx)(ew,{...e}):(0,t.jsx)(ek,{...e}),ek=({buckets:e,projectRef:a,filterString:r,formattedGlobalUploadLimit:s,pagination:{hasMore:i=!1,isLoadingMore:n=!1,onLoadMore:l}})=>{let o=0===e.length&&r.length>0;return(0,t.jsxs)(ei.Table,{containerProps:{containerClassName:"h-full overflow-auto",className:"overflow-visible"},children:[(0,t.jsx)(ej,{mode:"standard",hasBuckets:e.length>0}),(0,t.jsxs)(ei.TableBody,{children:[o?(0,t.jsx)(eb,{mode:"standard",filterString:r}):e.map(e=>(0,t.jsx)(ey,{mode:"standard",bucket:e,projectRef:a,formattedGlobalUploadLimit:s},e.id)),(0,t.jsx)(ev,{mode:"standard",colSpan:6,hasMore:i,isLoadingMore:n,onLoadMore:l})]})]})},ew=({buckets:e,projectRef:a,filterString:r,formattedGlobalUploadLimit:s,pagination:{hasMore:n=!1,isLoadingMore:l=!1,onLoadMore:o}})=>{let c=0===e.length&&r.length>0,d=(0,i.useRef)(null);return(0,t.jsxs)(el,{data:e,estimateSize:()=>59,getItemKey:e=>e.id,scrollContainerRef:d,children:[(0,t.jsx)(ej,{mode:"virtualized",hasBuckets:e.length>0}),(0,t.jsx)(eo,{paddingColSpan:5,emptyContent:c?(0,t.jsx)(eb,{mode:"virtualized",filterString:r}):void 0,trailingContent:(0,t.jsx)(ev,{mode:"virtualized",colSpan:6,hasMore:n,isLoadingMore:l,onLoadMore:o}),children:e=>(0,t.jsx)(ey,{mode:"virtualized",bucket:e,projectRef:a,formattedGlobalUploadLimit:s},e.id)})]})},eP=()=>{let{ref:e}=(0,n.useParams)(),S=(0,f.useStorageExplorerStateSnapshot)(),[k,w]=(0,i.useState)(""),P=(0,a.useDebounce)(k,250).trim(),N=S.sortBucket===et.STORAGE_BUCKET_SORT.ALPHABETICAL?"name":"created_at",A=S.sortBucket===et.STORAGE_BUCKET_SORT.ALPHABETICAL?"asc":"desc",[R,C]=(0,p.useQueryState)("new",p.parseAsBoolean.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),{data:E}=(0,d.useProjectStorageConfigQuery)({projectRef:e},{enabled:m.IS_PLATFORM}),{data:T,error:I,isError:B,isPending:z,isSuccess:M,isFetching:L,fetchNextPage:D,hasNextPage:F}=(0,u.usePaginatedBucketsQuery)({projectRef:e,search:P.length>0?P:void 0,sortColumn:N,sortOrder:A}),O=(0,i.useMemo)(()=>T?.pages.flatMap(e=>e)??[],[T]).filter(e=>!("type"in e)||"STANDARD"===e.type),$=0===O.length&&0===P.length,H=(0,h.formatBytes)(E?.fileSizeLimit??0),U=B&&I.message.includes("Project has no active API keys"),V=(0,i.useCallback)(()=>{F&&!L&&D()},[F,L,D]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.PageContainer,{children:(0,t.jsx)(v.PageSection,{children:(0,t.jsxs)(v.PageSectionContent,{className:"h-full gap-y-4",children:[z&&(0,t.jsx)(c.GenericSkeletonLoader,{}),B&&(0,t.jsx)(t.Fragment,{children:U?(0,t.jsx)(b.Admonition,{type:"warning",title:"Project has no active API keys enabled",children:(0,t.jsxs)("p",{className:"!leading-normal text-sm",children:["The Dashboard relies on having active API keys on the project to function. If you'd like to use Storage through the Dashboard, create a set of API keys"," ",(0,t.jsx)(o.InlineLink,{href:`/project/${e}/settings/api-keys/new`,children:"here"}),"."]})}):(0,t.jsx)(l.default,{error:I,subject:"Failed to retrieve buckets"})}),M&&(0,t.jsx)(t.Fragment,{children:$?(0,t.jsx)(X.EmptyBucketState,{bucketType:"files",onCreateBucket:()=>C(!0)}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-grow justify-between gap-x-2 items-center mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,t.jsx)(y.Input,{size:"tiny",className:"flex-grow lg:flex-grow-0 w-52",placeholder:"Search for a bucket",value:k,onChange:e=>w(e.target.value),icon:(0,t.jsx)(s.Search,{})}),(0,t.jsxs)(j.DropdownMenu,{children:[(0,t.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(g.Button,{type:"default",icon:(0,t.jsx)(r.ArrowDownNarrowWide,{}),children:["Sorted by ","alphabetical"===S.sortBucket?"name":"created at"]})}),(0,t.jsx)(j.DropdownMenuContent,{align:"start",className:"w-40",children:(0,t.jsxs)(j.DropdownMenuRadioGroup,{value:S.sortBucket,onValueChange:e=>S.setSortBucket(e),children:[(0,t.jsx)(j.DropdownMenuRadioItem,{value:"alphabetical",children:"Sort by name"}),(0,t.jsx)(j.DropdownMenuRadioItem,{value:"created_at",children:"Sort by created at"})]})})]})]}),(0,t.jsx)(ee.CreateBucketButton,{onClick:()=>C(!0)})]}),(0,t.jsx)(x.Card,{children:(0,t.jsx)(eS,{buckets:O,projectRef:e??"_",filterString:k,formattedGlobalUploadLimit:H,pagination:{hasMore:F,isLoadingMore:L,onLoadMore:V}})})]})})]})})}),(0,t.jsx)(J,{open:R,onOpenChange:C})]})};var eN=e.i(448710),eA=e.i(904987),eR=e.i(209636);let eC=()=>(0,t.jsx)(eP,{});eC.getLayout=e=>(0,t.jsx)(eN.default,{children:(0,t.jsx)(eR.default,{title:"Storage",children:(0,t.jsx)(eA.StorageBucketsLayout,{children:e})})}),e.s(["default",0,eC],936919)},332098,(e,t,a)=>{let r="/project/[ref]/storage/files";(window.__NEXT_P=window.__NEXT_P||[]).push([r,()=>e.r(936919)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([r])})},111410,e=>{e.v(t=>Promise.all(["static/chunks/a428d2b7e6671266.js","static/chunks/92a7c4be60dd12e3.js"].map(t=>e.l(t))).then(()=>t(677146)))},883471,e=>{e.v(t=>Promise.all(["static/chunks/69b2faaedd35af23.js"].map(t=>e.l(t))).then(()=>t(518769)))},587525,e=>{e.v(t=>Promise.all(["static/chunks/da2f61ca91d09b7f.js"].map(t=>e.l(t))).then(()=>t(127351)))},168845,e=>{e.v(t=>Promise.all(["static/chunks/99714db866f77205.js"].map(t=>e.l(t))).then(()=>t(238625)))},591393,e=>{e.v(t=>Promise.all(["static/chunks/e9ad074e72197584.js"].map(t=>e.l(t))).then(()=>t(217383)))},379416,e=>{e.v(t=>Promise.all(["static/chunks/d690909a90d04a2e.js"].map(t=>e.l(t))).then(()=>t(931066)))},15732,e=>{e.v(t=>Promise.all(["static/chunks/0d5256e667945be4.js"].map(t=>e.l(t))).then(()=>t(760545)))},957083,e=>{e.v(t=>Promise.all(["static/chunks/e7d07ff1ae210964.js"].map(t=>e.l(t))).then(()=>t(667558)))},207969,e=>{e.v(t=>Promise.all(["static/chunks/8dd7282c22f923f6.js"].map(t=>e.l(t))).then(()=>t(427328)))},992842,e=>{e.v(t=>Promise.all(["static/chunks/d064a48a1c7cf778.js"].map(t=>e.l(t))).then(()=>t(793794)))},239573,e=>{e.v(t=>Promise.all(["static/chunks/edc5d84148401903.js"].map(t=>e.l(t))).then(()=>t(210246)))},963685,e=>{e.v(t=>Promise.all(["static/chunks/92b20126e5ca0919.js"].map(t=>e.l(t))).then(()=>t(983756)))},665811,e=>{e.v(t=>Promise.all(["static/chunks/e37e25f8b82619ef.js"].map(t=>e.l(t))).then(()=>t(544836)))},369256,e=>{e.v(t=>Promise.all(["static/chunks/8296dc618dae72f0.js"].map(t=>e.l(t))).then(()=>t(930239)))},16037,e=>{e.v(t=>Promise.all(["static/chunks/3251b4bc539a554b.js"].map(t=>e.l(t))).then(()=>t(397698)))},616788,e=>{e.v(t=>Promise.all(["static/chunks/c6b81ab43a1d5d23.js"].map(t=>e.l(t))).then(()=>t(7346)))},315750,e=>{e.v(t=>Promise.all(["static/chunks/32c236321136eb7c.js"].map(t=>e.l(t))).then(()=>t(531289)))},460510,e=>{e.v(t=>Promise.all(["static/chunks/d91062943e6a7c30.js"].map(t=>e.l(t))).then(()=>t(276898)))},550265,e=>{e.v(t=>Promise.all(["static/chunks/75ff0e62b8a31d26.js"].map(t=>e.l(t))).then(()=>t(259714)))},830960,e=>{e.v(t=>Promise.all(["static/chunks/b44aa26556fee7df.js"].map(t=>e.l(t))).then(()=>t(882885)))},336744,e=>{e.v(t=>Promise.all(["static/chunks/2b0767b5c008139a.js"].map(t=>e.l(t))).then(()=>t(955268)))},63631,e=>{e.v(t=>Promise.all(["static/chunks/21a4706e1f02d90b.js"].map(t=>e.l(t))).then(()=>t(853630)))},912072,e=>{e.v(t=>Promise.all(["static/chunks/c17c80e5efc43419.js"].map(t=>e.l(t))).then(()=>t(311301)))},730314,e=>{e.v(t=>Promise.all(["static/chunks/dcadd9d46d72282e.js","static/chunks/df8f2d32c834951d.js","static/chunks/82dddbda1a808189.js","static/chunks/d3a06a9a43f3833e.js","static/chunks/87b9766a4d16d1da.js","static/chunks/cc8130a84ee9bc2c.css"].map(t=>e.l(t))).then(()=>t(686651)))}]);

//# debugId=74742da2-c0be-80c1-eebd-477486cbf0ab
//# sourceMappingURL=7eb28f3ed562e2b3.js.map